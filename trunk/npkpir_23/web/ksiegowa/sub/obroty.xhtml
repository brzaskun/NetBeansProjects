<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:ft="http://primefaces.prime.com.tr/facestrace">
    <p:commandButton  value="Zachowaj w pdf" actionListener="#{sesjaView.dodajwydruk()}" action="#{obrotyView.drukujObroty()}" >
    </p:commandButton>
    <p:commandButton id="obrotywysylka" value="Wyślij podatnikowi" actionListener="#{sesjaView.dodajmail()}" onclick="PF('confirmation').show();" style="display: none;">
    </p:commandButton>
    <p:panelGrid columns="4">
        <h:outputText value="   suma wartości netto wybranych dokumentów w zł: "/>
        <h:outputText  id="podsumowaniewybr" value="#{obrotyView.podsumowaniewybranychnetto}">
            <f:convertNumber minFractionDigits="2" locale="PL"/>
        </h:outputText>
        <h:outputText value=" -  suma wartości brutto wybranych dokumentów w zł: "/>
        <h:outputText  id="podsumowaniewybrnetto" value="#{obrotyView.podsumowaniewybranych}">
            <f:convertNumber minFractionDigits="2" locale="PL"/>
        </h:outputText>
    </p:panelGrid>
    <p:separator/>
    <p:outputPanel id="wrapper" deferred="true">

        <p:dataTable  var="wpis" value="#{obrotyView.obiektDOKmrjsfSelX}" id="dokumentyLista" filteredValue="#{obrotyView.dokumentyFiltered}"
                      selection="#{obrotyView.goscwybral}"  widgetVar="dokTable" 
                      rowStyleClass="#{wpis.rodzTrans eq 'sprzedaz' ? 'old' : null}" rowKey="#{wpis.idDok}"
                      style="max-width: 1400px;"  >
            <p:ajax event="toggleSelect" listener="#{obrotyView.sumawartosciwybranych}" update=":formX:podsumowaniewybr, :formX:podsumowaniewybrnetto"/>
            <p:ajax event="rowSelectCheckbox" listener="#{obrotyView.sumawartosciwybranych}" update=":formX:podsumowaniewybr, :formX:podsumowaniewybrnetto"/>
            <p:ajax event="rowUnselectCheckbox" listener="#{obrotyView.sumawartosciwybranych}" update=":formX:podsumowaniewybr, :formX:podsumowaniewybrnetto"/>
            <f:facet name="header">  
                <h:outputText value="Wykaz obrotow z kontrahentem" />
                <h:outputText value="- wyszukiwanie: " />  
                    <p:inputText id="globalFilter" onkeyup="PF('dokTable').filter()" style="width:180px" placeholder="wyszukiwane wyrażenie" />
                    <p:commandButton id="toggler" type="button" value="Kolumny" style="float:right" icon="ui-icon-calculator" />
                    <p:columnToggler datasource="dokumentyLista" trigger="toggler" />
            </f:facet>
            <p:column selectionMode="multiple"  style="width: 5%;" >
            </p:column>
            <p:column id="idColumn" headerText="#{mgs.numerkolejny}" filterStyle="display: none;" sortBy="#{wpis.idDok}"  style="width: 5%;">  
                <h:outputText value="#{wpis.nrWpkpir}" />
            </p:column>
            <p:column id="dataColumn" headerText="data wyst" filterBy="#{wpis.dataWyst}" filterMatchMode="contains" filterStyle="display: none;" sortBy="#{wpis.dataWyst}"  style="width: 9%;">  
                <h:outputText value="#{wpis.dataWyst}">
                    <f:convertDateTime dateStyle="medium"  />
                </h:outputText>
            </p:column>
            <p:column id="kontrColumn" headerText="#{mgs.kontrahent}" filterBy="#{wpis.kontr.npelna}" filterMatchMode="contains" filterStyle="display: none;" sortBy="#{wpis.kontr.npelna}" style="width: 14%;">  
                <h:outputText value="#{wpis.kontr.npelna}"  />
            </p:column>
            <p:column id="rodzTrColumn" headerText="rodzaj trans" filterBy="#{wpis.rodzTrans}" filterMatchMode="contains" filterStyle="display: none;" sortBy="#{wpis.rodzTrans}" style="width: 9%; text-align: center;">  
                <h:outputText value="#{wpis.rodzTrans}" />
            </p:column>
            <p:column id="typDokColumn" headerText="symbol dok" filterBy="#{wpis.typdokumentu}" filterMatchMode="contains" filterStyle="display: none;" sortBy="#{wpis.typdokumentu}" style="width: 9%; text-align: center;">  
                <h:outputText value="#{wpis.typdokumentu}" />
            </p:column>
            <p:column id="nrWlDokColumn" headerText="nr wł" filterBy="#{wpis.nrWlDk}" filterMatchMode="contains" filterStyle="display: none;" sortBy="#{wpis.nrWlDk}" style="width: 13%;">  
                <h:outputText value="#{wpis.nrWlDk}" />
            </p:column>
            <p:column id="opisColumn" headerText="#{mgs.opis}" filterBy="#{wpis.opis}" filterMatchMode="contains" filterStyle="display: none;" sortBy="#{wpis.opis}"  style="width: 12%;">  
                <h:outputText value="#{wpis.opis}" />
            </p:column>
            <p:column id="kwotanettoColumn" headerText="netto" filterBy="#{wpis.netto}" filterMatchMode="contains" filterStyle="display: none;" sortBy="#{wpis.netto}" style="width: 12%;">  
                <h:outputText value="#{wpis.netto}" style="padding-left: 20%; font-weight: 700; float: right">
                    <f:convertNumber  locale="PL" minFractionDigits="2" />
                </h:outputText>
            </p:column>
            <p:column id="kwotabruttoColumn" headerText="brutto" filterBy="#{wpis.brutto}" filterMatchMode="contains" filterStyle="display: none;" sortBy="#{wpis.brutto}" style="width: 12%;">  
                <h:outputText value="#{wpis.brutto}" style="padding-left: 20%; font-weight: 700; float: right">
                    <f:convertNumber  locale="PL" minFractionDigits="2" />
                </h:outputText>
            </p:column>

        </p:dataTable>

    </p:outputPanel>
</ui:composition>   

