<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:ft="http://primefaces.prime.com.tr/facestrace">

    <p:dialog header="Szczegóły ewidencji VAT" widgetVar="Dialog" resizable="false"  
              showEffect="explode" hideEffect="explode">  

        <p:dataTable id="display" var="subwpis" value="#{ksiegaView.selDokument.ewidencjaVAT}" style="width: 600px;" emptyMessage="dokument bez vat" >
            <p:column id="SubColumn1" >  
                <f:facet name="header">  
                    <h:outputText value="nazwa ewidencji" />  
                </f:facet> 
                <h:outputText value="#{subwpis.ewidencja.nazwa}" />
            </p:column>
            <p:column id="SubColumn1a" >  
                <f:facet name="header" >
                    <h:outputText value="kwota netto" /> 
                </f:facet> 
                <h:outputText value="#{subwpis.netto}" style="float: right;">
                    <f:convertNumber minFractionDigits="2" locale="PL"/>
                </h:outputText>
            </p:column>
            <p:column id="SubColumn2">  
                <f:facet name="header">  
                    <h:outputText value="kwota vat" />  
                </f:facet> 
                <h:outputText value="#{subwpis.vat}" style="float: right;">
                    <f:convertNumber minFractionDigits="2" locale="PL"/>
                </h:outputText>
            </p:column>
            <p:column id="SubColumn3">  
                <f:facet name="header">  
                    <h:outputText value="okres vat" />  
                </f:facet> 
                <h:outputText value="#{wpis.vatM}/#{wpis.vatR}" style="float: right;">
                    <f:convertNumber minFractionDigits="2" locale="PL"/>
                </h:outputText>
            </p:column>
        </p:dataTable>
    </p:dialog>  

    <p:outputPanel id="wrapper"  deferred="true">

        <p:dataTable  var="wpis" value="#{ksiegaView.lista}" id="dokumentyLista" 
                      rowKey="#{wpis.idDok}" selection="#{ksiegaView.selDokument}" selectionMode="single"
                      emptyMessage="W danym miesiącu nie było żadnych zapisów" 
                      scrollHeight="600" style="width: 1680px;"
                      > 

            <p:ajax event="rowSelect" update=":form:display"  />           

            <f:facet name="header">  
                <h:outputText value="Podatkowa księga przychodów i rozchodów" />  
            </f:facet>
            <p:columnGroup type="header">  
                <p:row> 
                    <p:column rowspan="2" headerText=""   width="20" />  
                    <p:column rowspan="2" headerText="lp"   width="40" />  
                    <p:column rowspan="2" headerText="Data zdarzenia gosp." width="75"  />  
                    <p:column rowspan="2" headerText="Nr dowodu księgowego"   width="120"/>  
                    <p:column colspan="2" headerText="Kontrahent"   width="320"/>  
                    <p:column rowspan="2" headerText="Opis zdarzenia gospodarcz"   width="100"/>  
                    <p:column colspan="3" headerText="Przychody"   width="270"/>
                    <p:column rowspan="2" headerText="Zakup towarów handlowych i materiałów wg cen zakupu"   width="90"/>  
                    <p:column rowspan="2" headerText="Koszty uboczne zakupu"    width="80"/>
                    <p:column colspan="4" headerText="Wydatki(koszty)"   width="300" />
                    <p:column rowspan="2" headerText="Uwagi"   width="60"/>  
                </p:row>  
                <p:row>  
                    <p:column headerText="imię i nazwisko (firma)"  />  
                    <p:column headerText="adres"   />  
                    <p:column headerText="wartość sprzedanych towarów i usług"   />  
                    <p:column headerText="pozostałe przychody"/>  
                    <p:column headerText="razem przychód (7+8)"   />  
                    <p:column headerText="wynagrodzenia w gotówce i w naturze"  />  
                    <p:column headerText="pozostałe wydatki"  />  
                    <p:column headerText="razem wydatki (13+14)"  />  
                    <p:column headerText="inwestycje"  />  
                </p:row>
                <p:row>  
                    <p:column headerText="1" />  
                    <p:column headerText="2" />  
                    <p:column headerText="3" />  
                    <p:column headerText="4" />  
                    <p:column headerText="5" />  
                    <p:column headerText="6" />  
                    <p:column headerText="7" />  
                    <p:column headerText="8" />  
                    <p:column headerText="9" />  
                    <p:column headerText="10" />  
                    <p:column headerText="11" />  
                    <p:column headerText="12" />  
                    <p:column headerText="13" />  
                    <p:column headerText="14" />  
                    <p:column headerText="15" />  
                    <p:column headerText="16" />  
                    <p:column headerText="17" />  
                </p:row>

            </p:columnGroup>  
            <p:column width="10" style="height: 20px;"> 
                <p:rowToggler rendered="#{wpis.nrWpkpir eq 0 ? false : true}"/>
            </p:column>
            <p:column id="idColumn" headerText="lp" sortBy="nrWpkpir" >  
                <h:outputText value="#{wpis.nrWpkpir}"  rendered="#{wpis.nrWpkpir eq 0 ? false : true}"/>
            </p:column>

            <p:column id="dataColumn" headerText="data wyst" filterBy="dataWyst" filterMatchMode="contains" sortBy="dataWyst" >  
                <h:outputText value="#{wpis.dataWyst}" ><f:convertDateTime dateStyle="medium"  /></h:outputText>
            </p:column>
            <p:column id="nrWlDokColumn" headerText="nr wł" filterBy="nrWlDk" filterMatchMode="contains"  sortBy="nrWlDk" >  
                <h:outputText value="#{wpis.nrWlDk}" style=" line-break: loose;"/>
            </p:column>
            <p:column id="kontrColumn" headerText="kontrahent" filterBy="kontr.npelna" filterMatchMode="contains" sortBy="kontr.npelna" >  
                <h:outputText value="#{wpis.kontr.npelna}"   />
            </p:column>
            <p:column id="kontrColumna" headerText="kontrahent" filterBy="kontr.miejscowosc" filterMatchMode="contains" sortBy="kontr.miejscowosc}">  
                <h:outputText value="#{wpis.kontr.kodpocztowy} #{wpis.kontr.miejscowosc} #{wpis.kontr.ulica} #{wpis.kontr.dom} #{wpis.kontr.lokal}"   rendered="#{wpis.kontr.ulica ne 'dowód wewnętrzny'}"/>
            </p:column>
            <p:column id="opisColumn" headerText="opis" filterBy="opis" filterMatchMode="contains" sortBy="nrWlDk" >  
                <h:outputText value="#{wpis.opis}" />
            </p:column>
            <p:column id="pkpirKolColumn" headerText="kolumna" filterBy="kolumna7" filterMatchMode="contains" sortBy="kolumna7" >  
                <h:outputText value="#{wpis.kolumna7}"  style="float: right;"><f:convertNumber minFractionDigits="2" locale="PL"/></h:outputText>
            </p:column>
            <p:column id="pkpirKolColumn8" headerText="kolumna" filterBy="kolumna8" filterMatchMode="contains" sortBy="kolumna8}">  
                <h:outputText value="#{wpis.kolumna8}"   style="float: right;"><f:convertNumber minFractionDigits="2" locale="PL"/></h:outputText>
            </p:column>
            <p:column id="pkpirKolColumn9" headerText="kolumna" filterBy="kolumna9" filterMatchMode="contains" sortBy="kolumna9" >  
                <h:outputText value="#{wpis.kolumna9}"   style="float: right;"><f:convertNumber minFractionDigits="2" locale="PL"/></h:outputText>
            </p:column>
            <p:column id="pkpirKolColumn10" headerText="kolumna" filterBy="kolumna10" filterMatchMode="contains" sortBy="kolumna10}">  
                <h:outputText value="#{wpis.kolumna10}"   style=" float: right;"><f:convertNumber minFractionDigits="2" locale="PL"/></h:outputText>
            </p:column>
            <p:column id="pkpirKolColumn11" headerText="kolumna" filterBy="kolumna11" filterMatchMode="contains" sortBy="kolumna11}">  
                    <h:outputText value="#{wpis.kolumna11}"   style=" float: right;"><f:convertNumber minFractionDigits="2" locale="PL"/></h:outputText>
            </p:column>
            <p:column id="pkpirKolColumn12" headerText="kolumna" filterBy="kolumna12" filterMatchMode="contains" sortBy="kolumna12}">  
                <h:outputText value="#{wpis.kolumna12}"   style=" float: right;"><f:convertNumber minFractionDigits="2" locale="PL"/></h:outputText>
            </p:column>
            <p:column id="pkpirKolColumn13" headerText="kolumna" filterBy="kolumna13" filterMatchMode="contains" sortBy="kolumna13}">  
                <h:outputText value="#{wpis.kolumna13}"   style=" float: right;"><f:convertNumber minFractionDigits="2" locale="PL"/></h:outputText>
            </p:column>
            <p:column id="pkpirKolColumn14" headerText="kolumna" filterBy="kolumna14" filterMatchMode="contains" sortBy="kolumna14}">  
                <h:outputText value="#{wpis.kolumna14}"   style=" float: right;"><f:convertNumber minFractionDigits="2" locale="PL"/></h:outputText>
            </p:column>
            <p:column id="pkpirKolColumn15" headerText="kolumna" filterBy="kolumna15" filterMatchMode="contains" sortBy="kolumna15}">  
                <h:outputText value="#{wpis.kolumna15}"   style=" float: right;"><f:convertNumber minFractionDigits="2" locale="PL"/></h:outputText>
            </p:column>
            <p:column id="uwagaColumn" headerText="uwagi" filterBy="uwagi" filterMatchMode="contains" sortBy="uwagi" >  
                <h:outputText value="#{wpis.uwagi}" />
            </p:column>
  <p:rowExpansion>
                <p:column id="ewidencjavat" headerText="ewidencjavat - netto - vat - op/zw" width="300" resizable="true">  
                    <p:dataTable var="subwpis" value="#{wpis.ewidencjaVAT}" emptyMessage="dokument bez vat"  resizableColumns="true" style="width: 600px;">
                    <p:column id="SubColumn1" headerText="ewidencja">  
                        <h:outputText value="#{subwpis.ewidencja.nazwa}" />
                    </p:column>
                    <p:column id="SubColumn1a"  headerText="netto">  
                        <h:outputText value="#{subwpis.netto}" style="float: right;">
                        <f:convertNumber minFractionDigits="2" locale="PL"/>
                        </h:outputText>
                    </p:column>
                    <p:column id="SubColumn2" headerText="vat">  
                          <h:outputText value="#{subwpis.vat}" style="float: right;">
                          <f:convertNumber minFractionDigits="2" locale="PL"/>
                          </h:outputText>
                    </p:column>
                    <p:column id="SubColumn3" headerText="op/zw">  
                        <h:outputText value="#{subwpis.estawka}" />
                    </p:column>
                      <p:column id="SubColumn4">  
                        <f:facet name="header">  
                            <h:outputText value="okres vat" />  
                        </f:facet> 
                        <h:outputText value="#{wpis.vatM}/#{wpis.vatR}" style="float: right;">
                        </h:outputText>
            </p:column>
                </p:dataTable>
            </p:column>
                </p:rowExpansion>

        </p:dataTable>
        <p:panel id="panelpkpir">
        <br/>
        <p:commandButton  value="Zachowaj w pdf" actionListener="#{sesjaView.dodajwydruk()}" action="#{pdfPkpir.drukujksiege()}" >
        </p:commandButton>

        <p:commandButton id="pkpirwysylka" value="Wyślij podatnikowi" actionListener="#{sesjaView.dodajmail()}" onclick="confirmation.show();" style="display: none;">
        </p:commandButton>
        </p:panel>

    </p:outputPanel>

</ui:composition>   

