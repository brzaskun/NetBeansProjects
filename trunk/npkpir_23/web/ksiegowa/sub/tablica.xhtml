<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:ft="http://primefaces.prime.com.tr/facestrace"
    xmlns:pe="http://primefaces.org/ui/extensions">
    <h:form id="form">
            <p:panelGrid id="prezentacjaPodatku" columns="13">
                <h:outputLabel value="okres: " style="font-style: italic;"/>
                <h:outputLabel value="#{PodatekView.rokmiesiac}"/>
                <h:outputLabel value="rodzaj opodatkowania: " style="font-style: italic;"/>
                <h:outputLabel value="#{PodatekView.opodatkowanie}"/>
                <h:outputLabel value="Przychody:"/>
                <h:outputLabel value="#{PodatekView.przychody}">
                    <f:convertNumber locale="PL" currencyCode="PLN" maxFractionDigits="2" type="currency" />
                </h:outputLabel>
                <h:outputLabel value="Koszty:" style="font-style: italic;"/>
                <h:outputLabel value="#{PodatekView.koszty}">
                    <f:convertNumber locale="PL" currencyCode="PLN" maxFractionDigits="2" type="currency" />
                </h:outputLabel>
                <h:outputLabel value="Wynik podatkowy:" style="font-style: italic;"/>
                <h:outputLabel value="#{PodatekView.dochód}">
                    <f:convertNumber locale="PL" currencyCode="PLN" maxFractionDigits="2" type="currency" />
                </h:outputLabel>
                <h:outputLabel value="Zaliczka za m-c:" style="font-style: italic;"/>
                <h:outputLabel value="#{PodatekView.podatek}">
                    <f:convertNumber locale="PL" currencyCode="PLN" maxFractionDigits="2" type="currency" />
                </h:outputLabel>

                <p:commandButton actionListener="#{PodatekView.sprawozdaniePodatkowe()}" value="Oblicz" update=":form:prezentacjaPodatku"/>
            </p:panelGrid>

            <p:contextMenu for="dokumentyLista">
                <p:menuitem value="Edytuj" update=":formM:messages" icon="ui-icon-calculator" onclick="dlg123.show();"/>
                <p:menuitem value="Okresowa" update=":formM:messages" icon="ui-icon-calculator" actionListener="#{fakturyokresoweView.dodajfaktureokresowa()}"/>
                <p:menuitem value="Drukuj" update=":formM:messages" actionListener="#{pdfPK.drukujPK()}" icon="ui-icon-disk" onsuccess="wydrukpk('#{WpisView.podatnikWpisu}');"/>
                <p:menuitem value="Usuń wiele" actionListener="#{DokTabView.destroygrupa()}" icon="ui-icon-trash" onclick="confirmation1.show();"/>
                <p:menuitem value="Switch" update=":formM:messages" actionListener="#{DokTabView.aktywacjadeaktywacja()}" icon="ui-icon-locked" />
            </p:contextMenu>
            <p:dataTable  var="wpis" value="#{DokTabView.obiektDOKmrjsfSel}" id="dokumentyLista" editable="true" 
                          style="width: 1500px;" rowKey="#{wpis.idDok}" selection="#{DokTabView.gosciuwybral}" widgetVar="dokTable"
                          rowStyleClass="#{wpis.rodzTrans eq 'sprzedaz' ? 'old' : (wpis.netto lt 0 ? 'korekta' : null)}" emptyMessage="W danym miesiącu nie było żadnych zapisów"
                          scrollable="true" scrollRows="4" selectionMode="multiple"
                          > 
                <p:ajax event="rowSelect"  listener="#{DokumentView.skopiujdoedycji}"/>
                <f:facet name="header">  
                    <h:outputText value="Zestawienie zaksięgowanych dokumentów " />  
                    <h:outputText value="- wyszukiwanie: " />  
                    <p:inputText id="globalFilter" onkeyup="dokTable.filter()" style="width:150px" />  
                </f:facet>
   
                <p:column width="10">
                    <p:rowToggler />
                </p:column>
                <p:column id="idColumn" headerText="lp" sortBy="#{wpis.nrWpkpir}"  width="20">  
                    <h:outputText value="#{wpis.nrWpkpir}" />
                </p:column>

                <p:column id="dataColumn" headerText="data wyst" filterBy="#{wpis.dataWyst}" filterStyle="display : none;" filterMatchMode="contains" sortBy="#{wpis.dataWyst}" width="70">  
                    <h:outputText value="#{wpis.dataWyst}"/>
                </p:column>
                <p:column id="kontrColumn" headerText="kontrahent" filterBy="#{wpis.kontr.npelna}" filterStyle="display : none;" filterMatchMode="contains" sortBy="#{wpis.kontr.npelna}" width="180">  
                    <h:outputText value="#{wpis.kontr.npelna} #{wpis.kontr.miejscowosc} - NIP #{wpis.kontr.nip}"  />
                </p:column>
                <p:column id="rodzTrColumn" headerText="rodzaj trans" filterBy="#{wpis.typdokumentu}" filterStyle="display : none;" filterMatchMode="contains" sortBy="#{wpis.typdokumentu}" width="40">  
                    <h:outputText value="#{wpis.typdokumentu}" style="float: left; margin-left: 40%;"/>
                </p:column>
                <p:column id="nrWlDokColumn" headerText="nr wł" filterBy="#{wpis.nrWlDk}" filterStyle="display : none;" filterMatchMode="contains" sortBy="#{wpis.nrWlDk}" width="110" >   
                    <p:cellEditor>  
                        <f:facet name="output">  
                            <h:outputText value="#{wpis.nrWlDk}" />
                        </f:facet>  
                        <f:facet name="input">  
                            <p:inputText value="#{wpis.nrWlDk}"/>
                        </f:facet>  
                    </p:cellEditor>
                </p:column>
                <p:column id="opisColumn" headerText="opis" filterBy="#{wpis.opis}" filterStyle="display : none;" filterMatchMode="contains" sortBy="#{wpis.nrWlDk}" width="110">  
                    <p:cellEditor>  
                        <f:facet name="output">  
                            <h:outputText value="#{wpis.opis}"/>
                        </f:facet>  
                        <f:facet name="input">  
                            <p:inputText value="#{wpis.opis}"/>
                        </f:facet>  
                    </p:cellEditor>
                </p:column>
                <p:column id="nettoColumn" headerText="netto" filterBy="#{wpis.netto}" filterStyle="display : none;" filterMatchMode="contains" filterValue="100" sortBy="#{wpis.netto}" width="100">  
                    <h:outputText value="#{wpis.netto}" style="float: right;">
                        <f:convertNumber minFractionDigits="2" locale="PL"/>
                    </h:outputText>
                </p:column>

                <p:column id="pkpirKolColumn" headerText="zapis w pkpir" width="250" resizable="true" >  
                    <p:dataTable id="tablicakolumn" var="subwpis" value="#{wpis.listakwot}" emptyMessage="dokument bez zapisu w pkpir"  resizableColumns="true" style="width: 250px;" lazy="false"   >
                        <p:column id="SubColumnP1" width="100">  
                            <h:outputText value="#{subwpis.netto}" style="float: right;">
                                <f:convertNumber minFractionDigits="2" locale="PL"/>
                            </h:outputText>
                            <h:outputText value="#{subwpis.nazwakolumny}" style="float: left;">
                                <f:convertNumber minFractionDigits="2" locale="PL"/>
                            </h:outputText>
                        </p:column>
                    </p:dataTable>
                </p:column>

                <p:rowExpansion>
                    <p:column id="ewidencjavat" headerText="ewidencjavat - netto - vat - op/zw" width="300" resizable="true">  
                        <p:dataTable var="subwpis" value="#{wpis.ewidencjaVAT}" emptyMessage="dokument bez vat"  resizableColumns="true" style="width: 600px;">
                            <p:column id="SubColumn1" headerText="ewidencja">  
                                <h:outputText value="#{subwpis.ewidencja.nazwa}" />
                            </p:column>
                            <p:column id="SubColumn1a"  headerText="netto">  
                                <h:outputText value="#{subwpis.netto}" style="float: right;">
                                    <f:convertNumber minFractionDigits="2" locale="PL"/>
                                </h:outputText>
                            </p:column>
                            <p:column id="SubColumn2" headerText="vat">  
                                <h:outputText value="#{subwpis.vat}" style="float: right;">
                                    <f:convertNumber minFractionDigits="2" locale="PL"/>
                                </h:outputText>
                            </p:column>
                            <p:column id="SubColumn3" headerText="op/zw">  
                                <h:outputText value="#{subwpis.estawka}" />
                            </p:column>
                            <p:column id="SubColumn4" headerText="okresy vat">  
                                <h:outputText value="#{wpis.vatM}/#{wpis.vatR}" style="float: right;"/>
                            </p:column>
                        </p:dataTable>
                    </p:column>
                </p:rowExpansion>
                <p:column id="vatMcColumn" headerText="v m-c" filterBy="#{wpis.vatM}" filterStyle="display : none;" filterMatchMode="contains" sortBy="#{wpis.vatM}" width="60" filterMaxLength="2">  
                    <p:cellEditor>  
                        <f:facet name="output">  
                            <h:outputText value="#{wpis.vatM}"/>
                        </f:facet>  
                        <f:facet name="input">  
                            <p:inputText value="#{wpis.vatM}"/>
                        </f:facet>  
                    </p:cellEditor>
                </p:column >
                <p:column id="status" headerText="status"  width="70">
                    <h:outputText value="#{wpis.status}"/>
                </p:column>

<!--                <p:column id="editColumn" headerText="edytuj" width="50">
                    <p:rowEditor rendered="{wpis.status eq 'bufor' ? true : false}" />  
                </p:column>-->
<!--                <p:column id="editDok" headerText="edytuj" width="50">
                    <p:commandButton  icon="ui-icon-wrench" actionListener="{DokumentView.przekierowanieEdytujDokument(wpis)}"/>
                </p:column>-->

                <p:column id="deleteColumn" headerText="usuń" width="50">
                    <p:commandButton actionListener="#{DokTabView.destroy(wpis)}" onclick="confirmation.show()" id="delete" icon="ui-icon ui-icon-trash" type="submit" rendered="#{wpis.status eq 'bufor' ? true : false}" />
                </p:column>
                <p:column id="usunpozornieColumn" headerText="mod" sortBy="#{wpis.usunpozornie}"  width="30">  
                    <h:outputText value="#{wpis.usunpozornie}" />
                </p:column>

            </p:dataTable>
         </h:form>

    <ui:include src="tablica_dialog.xhtml"/>

</ui:composition>   

