<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:bcf="http://brzaskun.com/facelets">
    <p:tab id="zestawienie" title="Faktury wystawione wg kontrahentow">
        <h:form id="formzestawienie">
            <p><p:commandButton value="pobierz" actionListener="#{fakturaZestView.init()}" update="@form, :form:messages" style="width: 120px;"/></p>
            <p:dataTable id="dokumentyZestawienie" value="#{fakturaZestView.fakturyZestawienie}" var="item"  rowIndexVar="row" 
                         rowKey="#{item.kontrahent.npelna}" style="max-width: 1200px;" widgetVar="zestTable" sortBy="#{item.kontrahent.npelna}" sortOrder="DESCENDING"
                         rowSelectMode="add"  emptyMessage="nie pobrano wierszy">
                <p:column width="300" sortBy="#{item.podatnik != null ? item.podatnik.nazwapelna : item.kontrahent}">
                    <h:outputText value="#{item.podatnik.nazwapelna}" rendered="#{item.podatnik != null}"/>
                    <h:outputText value="#{item.kontrahent}" rendered="#{item.kontrahent != null}"/>
                </p:column>
                <p:column>
                    <p:dataTable value="#{item.trescfaktury}" var="loop" sortBy="#{loop.mc}" rowIndexVar="rowA">
                        <p:column width="30">
                            <h:outputText value="#{loop.mc}"/>
                        </p:column>
                        <p:column>
                            <h:outputText value="#{loop.data}"/>
                        </p:column>
                        <p:column width="150">
                            <h:outputText value="#{loop.nrfakt}"/>
                        </p:column>
                        <p:column>
                            <h:outputText value="#{loop.opis}"/>
                        </p:column>
                        <p:column>
                            <bcf:outputpl value="#{loop.netto}" rendered="true"/>
                        </p:column>
                        <p:column>
                            <bcf:outputpl value="#{loop.vat}" rendered="true"/>
                        </p:column>
                        <p:column>
                            <bcf:outputpl value="#{loop.brutto}" rendered="true"/>
                        </p:column>
                        <p:column  headerText="PDF" style="text-align: center;"  width="50">
                            <p:commandButton  actionListener="#{pdfFaktura.drukuj(loop.faktura, rowA, WpisView)}" icon="ui-icon-print" />
                         </p:column>
                    </p:dataTable>
                </p:column>
                
            </p:dataTable>
        </h:form>
    </p:tab>
</ui:composition>   

