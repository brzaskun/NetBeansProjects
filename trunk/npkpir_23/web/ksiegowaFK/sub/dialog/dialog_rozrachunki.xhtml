<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:pe="http://primefaces.org/ui/extensions"
    >


    <p:dialog id="dialogdrugi" header="Rozrachunki" widgetVar="drugi" 
              resizable="false"  onShow="drugionShow();" closeOnEscape="true" onHide="rozrachunkionHide();" >
        <h:form id="rozrachunki" >
            <div style="height: 600px;">
                    <p:panelGrid id="paneledycji" columns="8" style="width: 1000px;">
                        <h:outputText value="nr dokumentu"/><h:outputText value="#{dokfkView.aktualnyWierszDlaRozrachunkow.wierszStronafk.wierszStronafkPK.nrkolejnydokumentu}/#{dokfkView.aktualnyWierszDlaRozrachunkow.wierszStronafk.wierszStronafkPK.typdokumentu}"/>
                        <h:outputText value="konto"/><h:outputText value="konto #{dokfkView.aktualnyWierszDlaRozrachunkow.wierszStronafk.konto.pelnynumer}"/>
                        <h:outputText value="kontrahent"/><h:outputText value="#{dokfkView.aktualnyWierszDlaRozrachunkow.wierszStronafk.wierszStronafkPK.podatnik}"/>
                        <h:outputText value="treść dokumentu"/><h:outputText value="#{dokfkView.aktualnyWierszDlaRozrachunkow.wierszStronafk.opisdokumentu}"/>
                        <h:outputText value="opis wiersza"/><h:outputText id="opiswierszaaktualnyrozrachunek" value="#{dokfkView.aktualnyWierszDlaRozrachunkow.wierszStronafk.opiswiersza}"/>
                        <h:outputText value="waluta"/><h:outputText value="#{dokfkView.aktualnyWierszDlaRozrachunkow.walutarozrachunku}"/>
                        <h:outputText value="kurs"/><h:outputText value="#{dokfkView.aktualnyWierszDlaRozrachunkow.wierszStronafk.kurswaluty}"/>
                        <h:outputText value="tabela"/><h:outputText value="#{dokfkView.aktualnyWierszDlaRozrachunkow.wierszStronafk.nrtabelinbp} z dnia #{dokfkView.aktualnyWierszDlaRozrachunkow.wierszStronafk.datawaluty}"/>
                        <h:outputText value="kwota pierwotna"/><h:outputText value="#{dokfkView.aktualnyWierszDlaRozrachunkow.kwotapierwotna}" style="float: right; font-weight: bold;">
                                <f:convertNumber minFractionDigits="2" locale="PL"/>
                        </h:outputText>
                        <h:outputText value="rozliczono"/><h:outputText value="#{dokfkView.aktualnyWierszDlaRozrachunkow.rozliczono}" style="float: right; font-weight: bold;">
                                <f:convertNumber minFractionDigits="2" locale="PL"/>
                        </h:outputText>
                        <h:outputText value="do rozliczenia"/><h:outputText id="dorozliczenia" value="#{dokfkView.aktualnyWierszDlaRozrachunkow.pozostalo}" style="float: right; font-weight: bold;">
                                <f:convertNumber minFractionDigits="2" locale="PL"/>
                        </h:outputText>
                    </p:panelGrid>
                <p:dataTable id="dataList" value="#{dokfkView.biezacetransakcje}" var="loop" rowIndexVar="row" style="width: 1200px; padding: 10px;"
                             emptyMessage="Nie ma zapisów po przeciwnej stronie na tym koncie lub transakcja jest traktowana wyłącznie jako Rozliczana" 
                             >
                    <f:facet name="header">
                        <h:outputText value="Dokumenty nie rozliczone"/>
                    </f:facet>
                   <p:column headerText="kwota rozliczenia - bieżący dok." width="40">
                       <pe:inputNumber id="kwotarozliczenia" value="#{loop.kwotatransakcji}" symbolPosition="s" decimalSeparator="." thousandSeparator=" " decimalPlaces="2" minValue="-10000000" rendered="#{!loop.zablokujnanoszenie}">
                           <f:ajax event="keyup" listener="#{dokfkView.wyliczroznicekursowa(loop, row)}" execute="@this" />
                       </pe:inputNumber>
                    </p:column>
                     <p:column headerText="zostało do rozliczenia" width="50">
                         <h:outputText id="pozostalo" value="#{loop.transakcjaPK.sparowany.pozostalo}" style="float: right;">
                            <f:convertNumber minFractionDigits="2" locale="PL"/>
                        </h:outputText>
                    </p:column>
                     <p:column headerText="kwota już rozliczona" width="50">
                         <h:outputText value="#{loop.transakcjaPK.sparowany.rozliczono}" style="float: right;">
                            <f:convertNumber minFractionDigits="2" locale="PL"/>
                        </h:outputText>
                    </p:column>
                    <p:column headerText="kwota transakcji" width="50">
                        <h:outputText value="#{loop.transakcjaPK.sparowany.kwotapierwotna}" style="float: right;">
                            <f:convertNumber minFractionDigits="2" locale="PL"/>
                        </h:outputText>
                    </p:column>
                    <p:column headerText="waluta" width="40" style="text-align: center">
                        <h:outputText id="waluta" value="#{loop.transakcjaPK.sparowany.wierszStronafk.symbolwaluty}" />
                    </p:column>
                    <p:column headerText="kurs" width="40">
                        <h:outputText id="kurs" value="#{loop.transakcjaPK.sparowany.wierszStronafk.kurswaluty}"  style="float: right;">
                            <f:convertNumber minFractionDigits="2" locale="PL"/>
                        </h:outputText>
                    </p:column>
                    <p:column headerText="roznica kursowa" width="40">
                        <h:outputText id="roznicakursowa" value="#{loop.roznicekursowe}"  style="float: right;">
                            <f:convertNumber minFractionDigits="2" locale="PL"/>
                        </h:outputText>
                    </p:column>
                     <p:column headerText="symbol dokumentu" width="50">
                         <h:outputText id="symboldok" value="#{loop.transakcjaPK.sparowany.wierszStronafk.wierszStronafkPK.typdokumentu}/#{loop.transakcjaPK.sparowany.wierszStronafk.wierszStronafkPK.nrkolejnydokumentu}" />
                    </p:column>
                    <p:column headerText="nr własny dokumentu" width="90">
                        <h:outputText id="nrwlasnydok" value="#{loop.transakcjaPK.sparowany.wierszStronafk.nrwlasnydokumentu}" />
                    </p:column>
                    <p:column headerText="opis wiersza" width="120">
                        <h:outputText id="opiswiersza" value="#{loop.transakcjaPK.sparowany.wierszStronafk.opiswiersza}" />
                    </p:column>
                    <p:column headerText="wiersz w dok" width="40"  style="text-align: center;">
                        <h:outputText value="#{loop.transakcjaPK.sparowany.wierszStronafk.wierszStronafkPK.nrPorzadkowyWiersza}"/>
                    </p:column>
<!--                    <p:column headerText="konto przeciwstawne" width="40">
                        <h:outputText value="{loop.wierszsparowany.kontoprzeciwstawne}"/>
                    </p:column>-->
                     <p:column headerText="dokument" width="80">
                         <h:outputText value="#{loop.transakcjaPK.sparowany.wierszStronafk.wierszStronafkPK.typdokumentu eq dokfkVaktualnyWierszDlaRozrachunkownkow.wierszStronafk.wierszStronafkPK.typdokumentu ? (loop.transakcjaPK.sparowany.wierszStronafk.wierszStronafkPK.nrkolejnydokumentu eq dokfkVaktualnyWierszDlaRozrachunkownkow.wierszStronafk.wierszStronafkPK.nrkolejnydokumentu ? 'zapis z bieżącego dokumentu' : null) : null}"/>
                    </p:column>

                </p:dataTable>
                
            </div>
            <p:commandButton value="Zapisz" styleClass="fkbutton" accesskey="z" actionListener="${dokfkView.zapistransakcji}" type="submit" oncomplete="drugi.hide();zablokujwierszereadonly();porzadkujwierszeporozrachunkach('#{dokfkView.selected.listawierszy.size()}');" update=":rozrachunki" style="margin-left: 10px;" rendered="#{!dokaktualnyWierszDlaRozrachunkowchunkow.nowatransakcja}"/>
        </h:form>
        <f:facet name="footer" >
            <div style="padding: 5px; height: 35px;">
                <h:form id="formcheckbox">
                    <h:selectBooleanCheckbox id="znaczniktransakcji" onfocus="zablokujcheckbox('#{dokfkVieaktualnyWierszDlaRozrachunkowow.rozliczono}');" accesskey="t" valueChangeListener="#{dokfkView.zaznaczOdznaczJakoNowaTransakcja}" value="#{dokfkView.potraktujjakoNowaTransakcje}" >
                        <f:ajax event="change" execute="@this" render=":wpisywaniefooter"/>
                </h:selectBooleanCheckbox>
                    <h:outputLabel for=":formcheckbox:znaczniktransakcji" value="nowa transakcja" style="font-weight: bolder;"/>
                    <p:commandButton value="pOwrót" styleClass="fkbutton" accesskey="o" onclick="pierwszy.show();drugi.hide();" style="float: right;" oncomplete="porzadkujwierszeporozrachunkach('#{dokfkView.selected.listawierszy.size()}');"/>
                </h:form>
            </div>
        </f:facet>
    </p:dialog>
</ui:composition>
