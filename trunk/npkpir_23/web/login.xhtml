
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" 
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:bcf="http://brzaskun.com/facelets">
    <f:view locale="#{localeChanger.locale}">
        <h:head>
            <meta http-equiv="Accept-Encoding" content="gzip"/>
            <h:outputStylesheet id="template" name="css/style.css"/>
            <h:outputScript library="js_common" name="language.js"/>
            <title>Biuro Rachunkowe Taxman</title>
        </h:head>
        <h:body>
            <script>
                navigator.sayswho= (function(){
                var ua= navigator.userAgent, tem,
                M= ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i) || [];
                if(/trident/i.test(M[1])){
                    tem=  /\brv[ :]+(\d+)/g.exec(ua) || [];
                    return 'IE '+(tem[1] || '');
                }
                if(M[1]=== 'Chrome'){
                    tem= ua.match(/\b(OPR|Edge)\/(\d+)/);
                    if(tem!= null) return tem.slice(1).join(' ').replace('OPR', 'Opera');
                }
                M= M[2]? [M[1], M[2]]: [navigator.appName, navigator.appVersion, '-?'];
                if((tem= ua.match(/version\/(\d+)/i))!= null) M.splice(1, 1, tem[1]);
                return info =  M.join(' ');
                
            })();
             $(document).ready(function() {
                if (navigator.sayswho.indexOf('Chrome')===-1) {
                    if (navigator.language === 'pl') {
                        alert("Ten program działa poprawnie jedynie w przeglądarce Chrome!");
                    } else if (navigator.language === 'de') {
                        alert("Die Software funktioniert nur unter Chrome Browser!");
                    } else if (navigator.language.indexOf('en-') > -1) {
                        alert("This Software works only with Chrome Browser!");
                    }
                }
            })
                
            </script>
                <p:notificationBar position="top" effect="slide" widgetVar="bar" styleClass="top" style="border: none;">  
                    <p style="text-align: center;"><h:outputText value="#{mgs.witamy}" style="color: activecaption; font-size:24px; " /></p>  
                </p:notificationBar> 
                <p:panel style="margin-left: auto; margin-right: auto; width: 400px; border: none" >
                    <div style="height: 100px;  margin-left: auto; margin-right: auto;">
                        <p:messages id="logowanie"  autoUpdate="true"/>
                    </div>

                    <p:panelGrid columns="3" style="text-align: center; margin-top: 7%; margin-left: auto; margin-right: auto; width: 400px; border-style: hidden !important;">
                        <p:column >
                            <h:link outcome="pomoclogowanie" value="#{mgs.pomoc}"/>
                        </p:column>
                        <p:column>
                            <h:link outcome="zapomnialem" value="#{mgs['zapomialem.hasla']}"/>
                        </p:column>
                        <p:column>
                            <h:link outcome="rejestruj" value="#{mgs.rejestracja}"/>
                        </p:column>
                    </p:panelGrid>
                </p:panel>
            <h:form id="formlog1">
                <p:panel style="margin-top: 2%; margin-left: auto; margin-right: auto; width: 380px" header="">
                    <p:focus id="focus" context="logowaniepanel"/>
                    <p:panelGrid id="logowaniepanel" columns="2" style="margin-left: auto; margin-right: auto; margin-top: 4%; width: 350px; text-align: center;"  rendered="#{logowanie.liczniklogowan gt 0}">
                        <h:outputText value="#{mgs.login}"/>
                        <h:inputText value="#{logowanie.uzytkownik}" accesskey="s" required="true" style="width: 150px;" requiredMessage="Wpisz login!" 
                                     autocomplete="true" onkeydown="PF('bar').show()">
                            <p:ajax event="blur" listener="#{logowanie.ustawLocale(logowanie.uzytkownik)}" partialSubmit="true" global="false" />
                        </h:inputText>
                        <h:outputText value="#{mgs.haslo}"/>
                        <h:inputSecret value="#{logowanie.haslo}" required="true" style="width: 150px;" requiredMessage="Wpisz hasło!" autocomplete="true" />
                    </p:panelGrid>
                    <br/>
                    <p:panelGrid id="logowaniebutton" columns="1" style="margin-left: auto; margin-right: auto; width: 350px; text-align: center; border: none !important;">
                        <p:commandButton value="#{mgs.zaloguj}" action="#{logowanie.login()}" ajax="false" style="width: 150px;" 
                                         icon="fa fa-user" rendered="#{logowanie.liczniklogowan gt 0}"/>
                        <h:outputText value="Logowanie do systemu z tego numeru IP zostalo zablokowane na 24 godziny ze względów bezpieczeństwa. Podczas ostatniego loginu wielokrotnie podano złe dane logujące. Skontaktuj się z adminem lub odczekaj 24h." rendered="#{logowanie.liczniklogowan eq 0}"/>
                    </p:panelGrid>
                    <!--                        <p:commandButton value="Wyloguj" action="{Logowanie.logout()}" update=":formlog1:logowanie" ajax="false"/>-->
                </p:panel>
            </h:form>
            <p:panel style="margin-left: auto; margin-right: auto; width: 400px; border: none; text-align: right;" >
                <h:form>
                    <p:commandButton styleClass="languagebutton" value="pl" actionListener="#{localeChanger.polishAction}" type="submit" update="@all"/>
                    <p:commandButton styleClass="languagebutton" value="en" actionListener="#{localeChanger.englishAction}" type="submit" update="@all"/>
                    <p:commandButton styleClass="languagebutton" value="de" actionListener="#{localeChanger.deutschAction}" type="submit" update="@all"/>
                </h:form>
            </p:panel>
            <h:form id="infologowanie" >
                <p:panel style="margin-left: auto; margin-right: auto; width: 300px; border: none; text-align: center; font-size: smaller;" >
                    <h:outputFormat value="#{mgs.twojeIP1}" style="color: gray;">
                        <f:param value="#{logowanie.ipusera}"/>
                    </h:outputFormat>
                    <br/>
                    <h:outputFormat value="#{mgs.twojeIP2}">
                        <f:param value="#{logowanie.liczniklogowan}"/>
                    </h:outputFormat>
                </p:panel>
            </h:form>
            <!--eefe-->
        </h:body>
    </f:view>
</html>