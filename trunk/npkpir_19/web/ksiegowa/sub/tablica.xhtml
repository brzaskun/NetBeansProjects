<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:ft="http://primefaces.prime.com.tr/facestrace">
    

   <p:outputPanel>
        <h:outputText value="Wstępne wyliczenie wyniku za wyświetlany miesiąc"/>
        <p:panelGrid id="prezentacjaPodatku" columns="4">
            <h:outputLabel value="okres: " style="font-style: italic;"/>
            <h:outputLabel value="#{PodatekView.rokmiesiac}"/>
            <h:outputLabel value="rodzaj opodatkowania: " style="font-style: italic;"/>
            <h:outputLabel value="#{PodatekView.opodatkowanie}"/>
        </p:panelGrid>
        <p:panelGrid id="prezentacjaPodatku1" columns="8">
            <h:outputLabel value="Przychody:" style="font-style: italic;"/>
            <h:outputLabel value="#{PodatekView.przychody}" style="font-size: medium;">
                <f:convertNumber locale="PL" currencyCode="PLN" maxFractionDigits="2" type="currency" />
            </h:outputLabel>
            <h:outputLabel value="Koszty:" style="font-style: italic;"/>
            <h:outputLabel value="#{PodatekView.koszty}" style="font-size: medium;">
                <f:convertNumber locale="PL" currencyCode="PLN" maxFractionDigits="2" type="currency" />
            </h:outputLabel>
            <h:outputLabel value="Wynik podatkowy:" style="font-style: italic;"/>
            <h:outputLabel value="#{PodatekView.dochód}" style="font-size: medium;">
                <f:convertNumber locale="PL" currencyCode="PLN" maxFractionDigits="2" type="currency" />
            </h:outputLabel>
            <h:outputLabel value="Zaliczka za m-c:" style="font-style: italic;"/>
            <h:outputLabel value="#{PodatekView.podatek}" style="font-size: large;">
                <f:convertNumber locale="PL" currencyCode="PLN" maxFractionDigits="2" type="currency" />
            </h:outputLabel>
        </p:panelGrid>
        <p:commandButton actionListener="#{PodatekView.sprawozdaniePodatkowe()}" value="Oblicz" update=":form:prezentacjaPodatku, :form:prezentacjaPodatku1"/>
    </p:outputPanel>
  
    <p:outputPanel id="wrapper">
        
        <p:dataTable  var="wpis" value="#{DokTabView.obiektDOKmrjsfSel}" id="dokumentyLista" editable="true" 
                      paginator="true" paginatorAlwaysVisible="true" rows="#{DokTabView.uzytkownik.iloscwierszy}"
                      paginatorTemplate="{FirstPageLink} {PageLinks} {LastPageLink} {RowsPerPageDropdown}" 
                      rowsPerPageTemplate="18,24,32,50" rowKey="#{wpis.idDok}" selection="#{DokTabView.selDokument}" selectionMode="single"
                      rowStyleClass="#{wpis.rodzTrans eq 'sprzedaz' ? 'old' : null}" emptyMessage="W danym miesiącu nie było żadnych zapisów"
                      > 
          
            <p:ajax event="rowEdit" update=":form:messages" listener="#{DokTabView.edit}" />
                        
            <f:facet name="header">  
                <h:outputText value="Wykaz dokumentów" /> 
            </f:facet>
            <p:column width="10">
                <p:rowToggler />
            </p:column>
            <p:column id="idColumn" headerText="lp" sortBy="#{wpis.nrWpkpir}"  width="30">  
                <h:outputText value="#{wpis.nrWpkpir}" />
            </p:column>
                
            <p:column id="dataColumn" headerText="data wyst" filterBy="#{wpis.dataWyst}" filterMatchMode="contains" sortBy="#{wpis.dataWyst}" >  
                        <h:outputText value="#{wpis.dataWyst}"/>
            </p:column>
            <p:column id="kontrColumn" headerText="kontrahent" filterBy="#{wpis.kontr.npelna}" filterMatchMode="contains" sortBy="#{wpis.kontr.npelna}">  
                <h:outputText value="#{wpis.kontr.npelna} #{wpis.kontr.miejscowosc} #{wpis.kontr.nip}"  />
            </p:column>
            <p:column id="rodzTrColumn" headerText="rodzaj trans" filterBy="#{wpis.rodzTrans}" filterMatchMode="contains" sortBy="#{wpis.rodzTrans}">  
                <h:outputText value="#{wpis.rodzTrans}" />
            </p:column>
            <p:column id="nrWlDokColumn" headerText="nr wł" filterBy="#{wpis.nrWlDk}" filterMatchMode="contains" sortBy="#{wpis.nrWlDk}">  
                <p:cellEditor>  
                    <f:facet name="output">  
                        <h:outputText value="#{wpis.nrWlDk}"/>
                    </f:facet>  
                    <f:facet name="input">  
                        <p:inputText value="#{wpis.nrWlDk}"/>
                    </f:facet>  
                </p:cellEditor>
            </p:column>
            <p:column id="opisColumn" headerText="opis" filterBy="#{wpis.opis}" filterMatchMode="contains" sortBy="#{wpis.nrWlDk}" >  
                 <p:cellEditor>  
                    <f:facet name="output">  
                        <h:outputText value="#{wpis.opis}"/>
                    </f:facet>  
                    <f:facet name="input">  
                        <p:inputText value="#{wpis.opis}"/>
                    </f:facet>  
                </p:cellEditor>
            </p:column>
              <p:column id="pkpirKolColumn0" headerText="netto" filterBy="#{wpis.netto}" filterMatchMode="contains" sortBy="#{wpis.netto}">  
                  <h:outputText value="#{wpis.netto}" style="padding-left: 20%; font-weight: 700; float: right;">
                            <f:convertNumber minFractionDigits="2" locale="PL" />
                        </h:outputText>
            </p:column>
            <p:column id="kwotaColumn" headerText="kwota">  
                        <h:outputText value="#{wpis.kwota}" style="padding-left: 10%; float: right;">
                            <f:convertNumber minFractionDigits="2" locale="PL" />
                        </h:outputText>
            </p:column>
            <p:column id="pkpirKolColumn" headerText="kolumna" filterBy="#{wpis.pkpirKol}" filterMatchMode="contains" sortBy="#{wpis.pkpirKol}">  
                <h:outputText value="#{wpis.pkpirKol}" />
            </p:column>
              <p:column id="kwotaColumnX" headerText="kwota" >  
                        <h:outputText value="#{wpis.kwotaX}" style="padding-left: 10%; float: right;">
                           <f:convertNumber minFractionDigits="2" locale="PL"/>
                        </h:outputText>
            </p:column>
            <p:column id="pkpirKolColumnX" headerText="kolumna" >  
                <h:outputText value="#{wpis.pkpirKolX}" />
            </p:column>
            <p:rowExpansion>
                <p:column id="ewidencjavat" headerText="ewidencjavat - netto - vat - op/zw" width="300" resizable="true">  
                 <p:dataTable var="subwpis" value="#{wpis.ewidencjaVAT}" emptyMessage="dokument bez vat"  resizableColumns="true">
                    <p:column id="SubColumn1" headerText="ewidencja">  
                        <h:outputText value="#{subwpis.ewidencja.nazwa}" />
                    </p:column>
                    <p:column id="SubColumn1a"  headerText="netto">  
                        <h:outputText value="#{subwpis.netto}" style="float: right;">
                        <f:convertNumber minFractionDigits="2" locale="PL"/>
                        </h:outputText>
                    </p:column>
                    <p:column id="SubColumn2" headerText="vat">  
                          <h:outputText value="#{subwpis.vat}" style="float: right;">
                          <f:convertNumber minFractionDigits="2" locale="PL"/>
                          </h:outputText>
                    </p:column>
                    <p:column id="SubColumn3" headerText="op/zw">  
                        <h:outputText value="#{subwpis.estawka}" />
                    </p:column>
                </p:dataTable>
            </p:column>
                </p:rowExpansion>
             <p:column id="vatMcColumn" headerText="v m-c" filterBy="#{wpis.vatM}" filterMatchMode="contains" sortBy="#{wpis.vatM}" width="60" filterMaxLength="2">  
                <h:outputText value="#{wpis.vatM}" />
            </p:column>
                    <p:column id="status" headerText="status"  width="90">
                    <h:outputText value="#{wpis.status}"/>
                </p:column>
          
             <p:column id="editColumn" headerText="edytuj" >
                     <p:rowEditor rendered="#{wpis.status eq 'bufor' ? true : false}" />  
              </p:column>
              <p:column id="editDok" headerText="edytuj" >
                  <p:commandButton  icon="ui-icon-wrench" actionListener="#{DokumentView.przekierowanieEdytujDokument(wpis)}"/>
              </p:column>

                <p:column id="deleteColumn" headerText="usuń" >
                    <p:commandButton actionListener="#{DokTabView.destroy(wpis)}" onclick="confirmation.show()" id="delete" icon="ui-icon ui-icon-trash" type="submit" rendered="#{wpis.status eq 'bufor' ? true : false}" />
                </p:column>

        </p:dataTable>
    </p:outputPanel>
    
</ui:composition>   

