
<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:ft="http://primefaces.prime.com.tr/facestrace"
    xmlns:pe="http://primefaces.org/ui/extensions">

    <h:form id="dodWiad">
    <p:panel menuTitle="Wprowadzanie dokumentów klient" header="Wprowadzanie dokumentów klient: #{WpisView.podatnikWpisu} okres: #{WpisView.rokWpisu}/#{WpisView.miesiacWpisu}" style="width: 1050px;" id="wprowadzanie">
        <p:growl id="mess_add" />
        <p:focus for="polawprowadzania"/>
        <p:panelGrid id="polawprowadzania" columns="5" >
            <h:outputLabel value="data wyst" style="font-weight: 700"/>
            <h:outputLabel value="kontrahent" style="font-weight: 700"/>
            <h:outputLabel value="rodzaj dok" style="font-weight: 700"/>
            <h:outputLabel value="nr wł" style="font-weight: 700"/>
            <h:outputLabel value="opis" style="font-weight: 700"/>

            <h:inputText id="dataPole" value="#{DokumentView.selDokument.dataWyst}"   accesskey="s" maxlength="10" style="width: 120px" size="10"  required="true" requiredMessage="Pole daty nie może byc puste" immediate="false"  >
                <p:ajax event="blur" listener="#{DokumentView.ustawDate2}" update="dataPole :dodWiad:dataSPole"  />
            </h:inputText>
            <h:panelGroup id="dwadoWprowadzania">
                <p:autoComplete id="acForce" value="#{DokumentView.selDokument.kontr}" completeMethod="#{KlView.complete}"
                                var="p" itemLabel="#{p.npelna}" itemValue="#{p}" converter="KlientConv" 
                                minQueryLength="3" maxResults="10" maxlength="10" converterMessage="Nieudana konwersja Klient"
                                effect="clip"  valueChangeListener="#{DokumentView.przekazKontrahenta}" 
                                required="true" requiredMessage="Pole klienta nie może byc puste" queryDelay="100" onblur="validateK();">
                    <f:ajax event="blur" execute="@this" />
                    <f:facet name="itemtip">  
                        <h:panelGrid  columns="2" cellpadding="5" width="400">  
                            <f:facet name="header">  
                                <h:outputText value="Dane kontrahenta"/>
                            </f:facet>  
                            <h:outputText value="Nazwa: " />  
                            <h:outputText id="npelna" value="#{p.npelna}" />  
                            <h:outputText value="Number " />  
                            <h:outputText id="nip" value="#{p.nip}" />  
                            <h:outputText value="Kolumna " />  
                            <h:outputText id="klumna" value="#{p.pkpirKolumna}" /> 
                        </h:panelGrid>
                    </f:facet>
                    <f:param name="passedValue" value="#{p}" />
                </p:autoComplete>

            </h:panelGroup>
            <h:selectOneMenu id="rodzajTrans" value="#{DokumentView.typdokumentu}"   style="width: 120px;" required="true" >
                <f:selectItems value="#{DokumentView.rodzajedokKlienta}" var="loop" itemLabel="#{loop.skrot}" itemValue="#{loop.skrot}"/>
                <p:ajax event="blur" listener="#{DokumentView.podepnijListe}"  update=":dodWiad:kolumnaPkpir :dodWiad:numerwlasny" global="false" oncomplete="aktywujopis()"/>
            </h:selectOneMenu>
            <h:inputText id="numerwlasny" value="#{DokumentView.selDokument.nrWlDk}" >
            </h:inputText>
            <p:autoComplete id="opis" value="#{DokumentView.selDokument.opis}" completeMethod="#{Opis.complete}"
                            var="p" itemLabel="#{p}" itemValue="#{p}" 
                            minQueryLength="2" maxResults="10" maxlength="20" 
                            effect="clip" autocomplete="true"  valueChangeListener="#{Opis.dodajOpis}"
                            required="true" requiredMessage="Brak opisu transakcji - uzupełnij"
                            queryDelay="100" >
                <p:ajax event="change" partialSubmit="true" global="false"/>
            </p:autoComplete>

        </p:panelGrid>
        <p:panelGrid columns="6">
            <h:outputLabel value="kwota" style="font-weight: 700"/>
            <h:outputLabel value="kolumna" style="font-weight: 700"/>
            <h:outputLabel value="rozliczony" style="font-weight: 700"/>
            <h:outputLabel value="termin płatności" style="font-weight: 700"/>
            <h:outputLabel value="kwota brutto" style="font-weight: 700"/>
            <h:outputLabel value="dok.prosty" style="font-weight: 700" />
            <pe:inputNumber id="kwotaPkpir" value="#{DokumentView.selDokument.kwota}" symbol=" zł" required="true" requiredMessage="Brak kwoty - uzupełnij" style="width: 120px" symbolPosition="s" decimalSeparator="." thousandSeparator=" " decimalPlaces="2" minValue="-10000000" >  
                <p:ajax event="blur" listener="#{DokumentView.przeniesKwotaDoNetto}" update=":dodWiad:grid1" global="false" />
                
            </pe:inputNumber>
            <h:selectOneMenu id="kolumnaPkpir" value="#{DokumentView.selDokument.pkpirKol}"  binding="#{DokumentView.pkpirLista}" style="min-width: 150px" onblur="updatesum();">
            </h:selectOneMenu>
            <h:selectBooleanCheckbox id="rozliczony" value="#{DokumentView.selDokument.rozliczony}" onchange="przekazdate()">
<!--                <p:ajax event="click" listener="{DokumentView.skopiujdoTerminuPlatnosci}" update=":dodWiad:dataTPole" global="false" />-->
            </h:selectBooleanCheckbox>
            <h:inputText id="dataTPole" value="#{DokumentView.selDokument.terminPlatnosci}" maxlength="10" style="width: 120px" required="true" requiredMessage="Brakuje terminu platnosci" onblur="validateTermin();">
            </h:inputText>
            <h:inputText id="sumbrutto"  readonly="true" onfocus="updatesum();"/>
             <h:selectBooleanCheckbox id="dokumentprosty" value="#{DokumentView.selDokument.dokumentProsty}">
                <p:ajax event="click" listener="#{DokumentView.dokumentProstuSchowajEwidencje()}" global="false"/>
            </h:selectBooleanCheckbox>
        </p:panelGrid>
            <p:commandButton id="dodatkowaKolumna" action="#{DokumentView.wygenerujNowaKolumnePkpir()}" value="DodKolumna" update=":form:messages" global="false" accesskey="g" style="display: none;" />  
<!--            <h:selectBooleanCheckbox id="dodatkowakolumna" value="{DokumentView.selDokument.dodatkowaKolumna}">
                <p:ajax event="click" listener="{DokumentView.wygenerujNowaKolumnePkpir}" global="false"/>
            </h:selectBooleanCheckbox>-->
        <!--dodatkowa kolumna pkpir-->
        <p:panelGrid id="grid2" columns="2" binding="#{DokumentView.grid2}">
        </p:panelGrid>
        <!--pola ewidencji SRODKOW TRWALYCH-->
        <p:panel header="wyszukiwarka środka trw." style="width: 300px;" >
                        <p:autoComplete id="acForce1" value="#{DokumentView.srodekkategoria}" completeMethod="#{srodkikstView.complete}"
                                        var="pa" itemLabel="#{pa.nazwa}" itemValue="#{pa}"  converter="SrodkiConv"
                                        minQueryLength="3" maxResults="15" maxlength="15" itemtipMyPosition="rightbottom"
                                        queryDelay="100" size="50" valueChangeListener="#{DokumentView.skopiujSTR()}">
                            <p:ajax event="blur" async="true" oncomplete="dataprzyjecia();"/>
                            <f:facet name="itemtip">  
                                <h:panelGrid  columns="2" cellpadding="5" width="400" >  
                                    <f:facet name="header">  
                                        <h:outputText value="Dane środka trwałego"/>
                                    </f:facet>  
                                    <h:outputText value="Nazwa: " />  
                                    <h:outputText id="npelna1" value="#{pa.nazwa}"/>  
                                    <h:outputText value="Stawka " />  
                                    <h:outputText id="nip1" value="#{pa.stawka}" />  
                                    <h:outputText value="KŚT " />  
                                    <h:outputText id="klumna1" value="#{pa.symbol}" /> 
                                </h:panelGrid>
                            </f:facet>
                        </p:autoComplete>
            </p:panel>
        <p:panel>
            <p:panelGrid id="grid3" columns="8" binding="#{DokumentView.grid3}">
            </p:panelGrid>
        </p:panel>

        <!--pola ewidencji VAT-->
        <p:panel>
            <p:panelGrid id="grid1" columns="#{DokumentView.wielkoscopisuewidencji}" binding="#{DokumentView.grid1}">
            </p:panelGrid>
        </p:panel>
        <!--pola ewidencji VAT-->
        <p:panelGrid columns="5">
            <h:outputLabel value="data sprzedaży" style="font-weight: 700"/>
            <h:outputLabel value="v m-c" style="font-weight: 700"/>
            <h:outputLabel value="v rok" style="font-weight: 700"/>
            <h:outputLabel value="uwagi" style="font-weight: 700"/>
            <h:outputLabel value=""/>

            <h:inputText id="dataSPole" value="#{DokumentView.selDokument.dataSprz}" maxlength="10" style="width: 120px" required="true" requiredMessage="Pole daty sprzedaży nie może byc puste"  onblur="updatesum()"/>
            <h:selectOneMenu id="vatm" value="#{DokumentView.selDokument.vatM}">
                <f:selectItems id="vatr" value="#{Mce.mceList}"/>
            </h:selectOneMenu>
            <h:selectOneMenu value="#{DokumentView.selDokument.vatR}">
                <f:selectItems value="#{Roki.rokiList}"/>
            </h:selectOneMenu>
            <h:inputText value="#{DokumentView.selDokument.uwagi}" />
            <p:commandButton id="wprowadzenieNowego" accesskey="w" action="#{sesjaView.dodajdokument()}" actionListener="#{DokumentView.dodaj()}" value="Dodaj" update="@form, :zobWiad:ostatniUzytkownik"> 
            </p:commandButton>
        </p:panelGrid>
    </p:panel>
        </h:form>
    <h:form id="zobWiad">
    <p:panel id="ostatniUzytkownik" header="Ostatnio wprowadzony dokument" style="width: 1300px" >
        <p:panelGrid columns="16">
            <h:outputLabel value="nr kolejny" style="font-weight: 600"/>
            <h:outputLabel value="data wyst" style="font-weight: 600"/>
            <h:outputLabel value="data sprzedaży" style="font-weight: 600"/>
            <h:outputLabel value="kontrahent" style="font-weight: 600"/>
            <h:outputLabel value="rodzaj trans" style="font-weight: 600"/>
            <h:outputLabel value="nr wł" style="font-weight: 600"/>
            <h:outputLabel value="opis" style="font-weight: 600"/>
            <h:outputLabel value="kwota" style="font-weight: 600"/>
            <h:outputLabel value="kolumna" style="font-weight: 600"/>
            <h:outputLabel value="kwota2" style="font-weight: 600"/>
            <h:outputLabel value="kolumna2" style="font-weight: 600"/>
            <h:outputLabel value="k m-c" style="font-weight: 600"/>
            <h:outputLabel value="k rok" style="font-weight: 600"/>
            <h:outputLabel value="v m-c" style="font-weight: 600"/>
            <h:outputLabel value="v rok" style="font-weight: 600"/>
            <h:outputLabel value="uwagi" style="font-weight: 600"/>
            <h:outputText  value="#{DokumentView.wysDokument.idDok}"/>
            <h:outputText  value="#{DokumentView.wysDokument.dataWyst}"><f:convertDateTime parent="dd/mm/yyyy"/></h:outputText>
            <h:outputText  value="#{DokumentView.wysDokument.dataSprz}"><f:convertDateTime parent="dd/mm/yyyy"/></h:outputText>
            <h:outputText  value="#{DokumentView.wysDokument.kontr.npelna}"/>
            <h:outputText  value="#{DokumentView.wysDokument.rodzTrans}"/>
            <h:outputText  value="#{DokumentView.wysDokument.nrWlDk}"/>
            <h:outputText  value="#{DokumentView.wysDokument.opis}"/>
            <h:outputText  value="#{DokumentView.wysDokument.kwota}"  style="float: right;">
                <f:convertNumber minFractionDigits="2" locale="PL"/>
            </h:outputText>
            <h:outputText  value="#{DokumentView.wysDokument.pkpirKol}"/>
            <h:outputText  value="#{DokumentView.wysDokument.kwotaX}"  style="float: right;">
                <f:convertNumber minFractionDigits="2" locale="PL"/>
            </h:outputText>
            <h:outputText  value="#{DokumentView.wysDokument.pkpirKolX}"/>
            <h:outputText  value="#{DokumentView.wysDokument.pkpirM}"/>
            <h:outputText  value="#{DokumentView.wysDokument.pkpirR}"/>
            <h:outputText  value="#{DokumentView.wysDokument.vatM}"/>
            <h:outputText  value="#{DokumentView.wysDokument.vatR}"/>
            <h:outputText  value="#{DokumentView.wysDokument.uwagi}"/>
        </p:panelGrid>
        <p:outputPanel id="wrapper">
            <p:dataTable value="#{DokumentView.wysDokument.ewidencjaVAT}"
                         var="p">
                <p:column id="idColumn" headerText="nazwa">  
                    <f:facet name="header">  
                        <h:outputText value="nazwa"/>  
                    </f:facet> 
                    <h:outputText value="#{p.ewidencja.nazwa}" />
                </p:column>
                <p:column id="idColumn0" headerText="zakup">  
                    <f:facet name="header">  
                        <h:outputText value="pozycja"/>  
                    </f:facet> 
                    <h:outputText value="#{p.ewidencja.rodzajzakupu}" />
                </p:column>
                <p:column id="idColumn1" headerText="pozycja">  
                    <f:facet name="header">  
                        <h:outputText value="pozycja"/>  
                    </f:facet> 
                    <h:outputText value="#{p.ewidencja.pole}" />
                </p:column>
                <p:column id="idColumn2" headerText="netto">  
                    <f:facet name="header">  
                        <h:outputText value="netto"/>  
                    </f:facet> 
                    <h:outputText value="#{p.netto}"  style="float: right;" >
                        <f:convertNumber minFractionDigits="2" locale="PL"/>
                    </h:outputText>

                </p:column>
                <p:column id="idColumn3" headerText="vat">  
                    <f:facet name="header">  
                        <h:outputText value="vat"/>  
                    </f:facet> 
                    <h:outputText value="#{p.vat}"  style="float: right;">
                        <f:convertNumber minFractionDigits="2" locale="PL"/>
                    </h:outputText>
                </p:column>
                <p:column id="idColumn4" headerText="op/zw">  
                    <f:facet name="header">  
                        <h:outputText value="op/zw"/>  
                    </f:facet> 
                    <h:outputText value="#{p.estawka}" />
                </p:column>
            </p:dataTable>
        </p:outputPanel>
        <!-- rozliczenie płatności-->
        <p:outputPanel id="wrapper1">
            <p:dataTable value="#{DokumentView.wysDokument.rozrachunki}"
                         var="p">
                <p:column id="idColumn" headerText="data zapłaty">  
                    <f:facet name="header">  
                        <h:outputText value="data zapłaty"/>  
                    </f:facet> 
                    <h:outputText value="#{p.dataplatnosci}" />
                </p:column>
                <p:column id="idColumn0" headerText="kwota zapłaty">  
                    <f:facet name="header">  
                        <h:outputText value="kwota zapłaty"/>  
                    </f:facet> 
                    <h:outputText value="#{p.kwotawplacona}" />
                </p:column>
                <p:column id="idColumn1" headerText="do rozliczenia">  
                    <f:facet name="header">  
                        <h:outputText value="do rozliczenia"/>  
                    </f:facet> 
                    <h:outputText value="#{p.dorozliczenia}" />
                </p:column>
            </p:dataTable>
        </p:outputPanel>
    </p:panel>
</h:form>
</ui:composition>   

