
<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:ft="http://primefaces.prime.com.tr/facestrace">
    <p:panel id="panelDodawaniaDokumentu">
        <p:panel menuTitle="Wprowadzanie dokumentów" header="Wprowadzanie dokumentów"  >
            <p:focus id="focus" context="polawprowadzania"/>
            <p:growl id="mess_add" tooltip="true" />
            <p:panelGrid id="polawprowadzania" columns="5" >
                <h:outputLabel value="data wyst" style="font-weight: 700"/>
                <h:outputLabel value="kontrahent" style="font-weight: 700"/>
                <h:outputLabel value="rodzaj trans" style="font-weight: 700"/>
                <h:outputLabel value="nr wł" style="font-weight: 700"/>
                <h:outputLabel value="opis" style="font-weight: 700"/>
               
                <h:inputText id="dataPole" value="#{DokumentView.selDokument.dataWyst}"  accesskey="s" maxlength="10" style="width: 120px" required="true" requiredMessage="Pole daty nie może byc puste">
                    <f:ajax event="keyup" execute="@this" listener="#{DokumentView.ustawDate}" render="dataPole" global="false" />
                </h:inputText>
                <h:panelGroup id="dwadoWprowadzania">
                    <p:autoComplete id="acForce" value="#{DokumentView.selDokument.kontr}" completeMethod="#{KlDAO.complete}"
                                    var="p" itemLabel="#{p.npelna}" itemValue="#{p}" converter="KlientConv" 
                                    minQueryLength="1" maxResults="5" maxlength="10" converterMessage="Nieudana konwersja Klient"  forceSelection="true" 
                                    effect="clip"  binding="#{DokumentView.kontrahentNazwa}" valueChangeListener="#{DokumentView.przekazKontrahenta}" 
                                    required="true" requiredMessage="Pole klienta nie może byc puste" queryDelay="100">

                        <f:ajax event="blur" execute="@this" global="false"/>
                            <f:facet name="itemtip">  
                            <h:panelGrid  columns="2" cellpadding="5" width="400">  
                                <f:facet name="header">  
                                    <h:outputText value="Dane kontrahenta"/>
                                </f:facet>  
                                <h:outputText value="Nazwa: " />  
                                <h:outputText id="npelna" value="#{p.npelna}" />  
                                <h:outputText value="Number " />  
                                <h:outputText id="nip" value="#{p.NIP}" />  
                                <h:outputText value="Kolumna " />  
                                <h:outputText id="klumna" value="#{p.pkpirKolumna}" /> 
                            </h:panelGrid>
                        </f:facet>
                        <f:param name="passedValue" value="#{p}" />
                    </p:autoComplete>
                </h:panelGroup>
                <h:selectOneListbox id="rodzajTrans" value="#{DokumentView.selDokument.rodzTrans}"   style="width: 120px" required="true">
                    <f:selectItems value="#{Trans.transListView}"/>
                    <p:ajax event="blur" listener="#{DokumentView.podepnijListe}"  update=":dodWiad:kolumnaPkpir " global="false"/>
                </h:selectOneListbox>
                <h:inputText value="#{DokumentView.selDokument.nrWlDk}" required="true" requiredMessage="Brak nr własnego dokumentu - uzupełnij" >
                    <f:validateLength minimum="3"/>
                </h:inputText>
                <p:autoComplete value="#{DokumentView.selDokument.opis}" completeMethod="#{Opis.complete}"
                                var="p" itemLabel="#{p}" itemValue="#{p}" 
                                minQueryLength="2" maxResults="10" maxlength="20" 
                                effect="clip" autocomplete="true"  valueChangeListener="#{Opis.dodajOpis}"
                                required="true" requiredMessage="Brak opisu transakcji - uzupełnij"
                                queryDelay="100">
                    <p:ajax event="change" partialSubmit="true" global="false"/>
                </p:autoComplete>
                
            </p:panelGrid>
            <p:panelGrid columns="5">
                <h:outputLabel value="kwota" style="font-weight: 700"/>
                <h:outputLabel value="kolumna" style="font-weight: 700"/>
                <h:outputLabel value="dod.kolumna" style="font-weight: 700"/>
                <h:outputLabel value="srod.trw." style="font-weight: 700"/>
                 <h:outputLabel value="dok.prosty" style="font-weight: 700"/>
                <h:inputText id="kwotaPkpir" value="#{DokumentView.selDokument.kwota}" required="true" requiredMessage="Brak kwoty - uzupełnij" 
                             style="width: 120px">
                <f:convertNumber />
                <p:ajax onevent="blur" listener="#{DokumentView.przeniesKwotaDoNetto}" update=":dodWiad:grid1" global="false"/>
                </h:inputText>
                <h:selectOneMenu id="kolumnaPkpir" value="#{DokumentView.selDokument.pkpirKol}"  binding="#{DokumentView.pkpirLista}" style="min-width: 150px">
                </h:selectOneMenu>
                <h:selectBooleanCheckbox id="dodatkowakolumna" value="#{DokumentView.selDokument.dodatkowaKolumna}">
                    <p:ajax event="click" listener="#{DokumentView.wygenerujNowaKolumnePkpir}" global="false"/>
                </h:selectBooleanCheckbox>
                <h:selectBooleanCheckbox  value="#{DokumentView.pokazSTR}" >
                    <p:ajax event="click" listener="#{DokumentView.wygenerujSTRKolumne}" global="false" />
                 </h:selectBooleanCheckbox>
                  <h:selectBooleanCheckbox id="dokumentprosty" value="#{DokumentView.selDokument.dokumentProsty}">
                    <p:ajax event="click" listener="#{DokumentView.dokumentProstuSchowajEwidencje()}" global="false"/>
                </h:selectBooleanCheckbox>
                
            </p:panelGrid>
            <!--dodatkowa kolumna pkpir-->
            <p:panelGrid id="grid2" columns="2" binding="#{DokumentView.grid2}">
            </p:panelGrid>
            <!--pola ewidencji SRODKOW TRWALYCH-->
             <p:panel >
                   <p:panelGrid id="grid3" columns="8" binding="#{DokumentView.grid3}">
                   </p:panelGrid>
             </p:panel>
            <!--pola ewidencji VAT-->
             <p:panel >
                   <p:panelGrid id="grid1" columns="3" binding="#{DokumentView.grid1}">
                   </p:panelGrid>
             </p:panel>
             
             
            <p:panelGrid columns="4">
                    <h:outputLabel value="v m-c" style="font-weight: 700"/>
                    <h:outputLabel value="v rok" style="font-weight: 700"/>
                    <h:outputLabel value="uwagi" style="font-weight: 700"/>
                    <h:outputLabel value=""/>


                    <h:selectOneMenu value="#{DokumentView.selDokument.vatM}">
                        <f:selectItems value="#{Mce.mceList}"/>
                    </h:selectOneMenu>
                    <h:selectOneMenu value="#{DokumentView.selDokument.vatR}" >
                        <f:selectItems value="#{Roki.rokiList}"/>
                    </h:selectOneMenu>
                    <h:inputText value="#{DokumentView.selDokument.uwagi}" />
                    <p:commandButton id="wprowadzenieNowego" accesskey="w" actionListener="#{DokumentView.dodajNowyWpis()}" value="Dodaj" update="mess_add,:dodWiad:ostatniUzytkownik, @form" global="false"/>   
                     
            </p:panelGrid>
         <p:panel id="ostatniUzytkownik" header="Ostatnio wprowadzony dokument">
            <p:panelGrid columns="15">
                <h:outputLabel value="nr kolejny" style="font-weight: 600"/>
                <h:outputLabel value="data wyst" style="font-weight: 600"/>
                <h:outputLabel value="kontrahent" style="font-weight: 600"/>
                <h:outputLabel value="rodzaj trans" style="font-weight: 600"/>
                <h:outputLabel value="nr wł" style="font-weight: 600"/>
                <h:outputLabel value="opis" style="font-weight: 600"/>
                <h:outputLabel value="kwota" style="font-weight: 600"/>
                <h:outputLabel value="kolumna" style="font-weight: 600"/>
                <h:outputLabel value="kwota2" style="font-weight: 600"/>
                <h:outputLabel value="kolumna2" style="font-weight: 600"/>
                <h:outputLabel value="k m-c" style="font-weight: 600"/>
                <h:outputLabel value="k rok" style="font-weight: 600"/>
                <h:outputLabel value="v m-c" style="font-weight: 600"/>
                <h:outputLabel value="v rok" style="font-weight: 600"/>
                <h:outputLabel value="uwagi" style="font-weight: 600"/>
                <h:outputText  value="#{DokumentView.wysDokument.idDok}"/>
                <h:outputText  value="#{DokumentView.wysDokument.dataWyst}">
                    <f:convertDateTime parent="dd/mm/yyyy"/>
                </h:outputText>
                <h:outputText  value="#{DokumentView.wysDokument.kontr.npelna}"/>
                <h:outputText  value="#{DokumentView.wysDokument.rodzTrans}"/>
                <h:outputText  value="#{DokumentView.wysDokument.nrWlDk}"/>
                <h:outputText  value="#{DokumentView.wysDokument.opis}"/>
                <h:outputText  value="#{DokumentView.wysDokument.kwota}">
                    <f:convertNumber maxFractionDigits="2"
                       groupingUsed="true"
                       currencySymbol="zł"
                       maxIntegerDigits="7"
                       type="currency"/>
                </h:outputText>
                <h:outputText  value="#{DokumentView.wysDokument.pkpirKol}"/>
                <h:outputText  value="#{DokumentView.wysDokument.kwotaX}"/>
                <h:outputText  value="#{DokumentView.wysDokument.pkpirKolX}"/>
                <h:outputText  value="#{DokumentView.wysDokument.pkpirM}"/>
                <h:outputText  value="#{DokumentView.wysDokument.pkpirR}"/>
                <h:outputText  value="#{DokumentView.wysDokument.vatM}"/>
                <h:outputText  value="#{DokumentView.wysDokument.vatR}"/>
                <h:outputText  value="#{DokumentView.wysDokument.uwagi}"/>
            </p:panelGrid>
            <p:outputPanel id="wrapper">
                <p:dataTable value="#{DokumentView.wysDokument.ewidencjaVAT}"
                             var="p">
                    <p:column id="idColumn" headerText="nazwa">  
                        <f:facet name="header">  
                            <h:outputText value="nazwa"/>  
                        </f:facet> 
                        <h:outputText value="#{p.ewidencja.nazwaEwidencji}" />
                    </p:column>
                    <p:column id="idColumn0" headerText="zakup">  
                        <f:facet name="header">  
                            <h:outputText value="pozycja"/>  
                        </f:facet> 
                        <h:outputText value="#{p.ewidencja.rodzajZakupu}" />
                    </p:column>
                    <p:column id="idColumn1" headerText="pozycja">  
                        <f:facet name="header">  
                            <h:outputText value="pozycja"/>  
                        </f:facet> 
                        <h:outputText value="#{p.ewidencja.pozycjaNaDeklaracji}" />
                    </p:column>
                    <p:column id="idColumn2" headerText="netto">  
                        <f:facet name="header">  
                            <h:outputText value="netto"/>  
                        </f:facet> 
                        <h:outputText value="#{p.netto}" />
                    </p:column>
                    <p:column id="idColumn3" headerText="vat">  
                        <f:facet name="header">  
                            <h:outputText value="vat"/>  
                        </f:facet> 
                        <h:outputText value="#{p.vat}" />
                    </p:column>
                </p:dataTable>
            </p:outputPanel>
        </p:panel>
    </p:panel>
    </p:panel>
    
</ui:composition>   

