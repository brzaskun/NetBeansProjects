<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:ft="http://primefaces.prime.com.tr/facestrace"
    xmlns:pe="http://primefaces.org/ui/extensions">
    
    
   <p:dialog header="Szczegóły płatności" widgetVar="Dialog" resizable="false"  
              showEffect="explode" hideEffect="explode">  
       <p:focus context="display"/>
           <p:panelGrid id="display" style="width: 400px;" columns="2" >
               <h:outputText value="data płatności"/>  
               <h:outputText value="kwota wpłacona"/>  
               <h:inputText value="#{DokumentView.rozrachunek.dataplatnosci}" accesskey="s" tabindex="1"/>
               <pe:inputNumber id="kwotaPkpir" value="#{DokumentView.rozrachunek.kwotawplacona}" symbol=" zł" required="true" requiredMessage="Brak kwoty - uzupełnij" style="width: 120px" symbolPosition="s" decimalSeparator="." thousandSeparator=" " decimalPlaces="2" >  
                    <f:convertNumber />
                </pe:inputNumber>
           </p:panelGrid>
       <br/>
       <p:commandButton value="ok" actionListener="#{DokumentView.zaksiegujPlatnosc}" style="float: right; display: block; width: 100px;" update=":form:dokumentyLista" tabindex="3"/>
    </p:dialog>  
    <p:outputPanel id="wrapper">
        
        <p:dataTable  var="wpis" value="#{DokTabView.niezaplacone}" id="dokumentyLista" editable="true" 
                      paginator="true" paginatorAlwaysVisible="true" rows="12"
                      paginatorTemplate="{FirstPageLink} {PageLinks} {LastPageLink} {RowsPerPageDropdown}" 
                      rowsPerPageTemplate="12,18,24,32,50" 
                      rowKey="#{wpis.idDok}" selection="#{DokumentView.selDokument}" selectionMode="single"
                      rowStyleClass="#{wpis.rodzTrans eq 'sprzedaz' ? 'old' : null}" emptyMessage="W danym miesiącu nie było żadnych zapisów"
                      > 
          
            <p:ajax event="rowEdit" update=":form:messages" listener="#{DokTabView.edit}" />
            <p:ajax event="rowSelect" update=":form:display" oncomplete="Dialog.show()" /> 
                        
            <f:facet name="header">  
                <h:outputText value="Wykaz dokumentów" />  
            </f:facet>
            
            <p:column id="idColumn" headerText="lp" sortBy="#{wpis.nrWpkpir}"  width="30">  
                <f:facet name="header">  
                    <h:outputText value="lp" />  
                </f:facet> 
                <h:outputText value="#{wpis.nrWpkpir}" />
            </p:column>
                
            <p:column id="dataColumn" headerText="data wyst" filterBy="#{wpis.dataWyst}" filterMatchMode="contains" sortBy="#{wpis.dataWyst}" >  
                <f:facet name="header">  
                    <h:outputText value="data wyst" />  
                </f:facet> 
                 <p:cellEditor>  
                    <f:facet name="output">  
                        <h:outputText value="#{wpis.dataWyst}"><f:convertDateTime dateStyle="medium"  /></h:outputText>
                    </f:facet>  
                    <f:facet name="input">  
                        <p:inputText value="#{wpis.dataWyst}"/>
                    </f:facet>  
                </p:cellEditor>
            </p:column>
            <p:column id="kontrColumn" headerText="kontrahent" filterBy="#{wpis.kontr.npelna}" filterMatchMode="contains" sortBy="#{wpis.kontr.npelna}">  
                <f:facet name="header">  
                    <h:outputText value="kontrahent" />  
                </f:facet> 
                <h:outputText value="#{wpis.kontr.npelna} miejscowość:#{wpis.kontr.miejscowosc} nip:#{wpis.kontr.nip}"  />
            </p:column>
            <p:column id="rodzTrColumn" headerText="rodzaj trans" filterBy="#{wpis.rodzTrans}" filterMatchMode="contains" sortBy="#{wpis.rodzTrans}">  
                <f:facet name="header">  
                    <h:outputText value="rodzaj trans" />  
                </f:facet> 
                <h:outputText value="#{wpis.rodzTrans}" />
            </p:column>
            <p:column id="nrWlDokColumn" headerText="nr wł" filterBy="#{wpis.nrWlDk}" filterMatchMode="contains" sortBy="#{wpis.nrWlDk}">  
                <f:facet name="header">  
                    <h:outputText value="nr wł" />  
                </f:facet> 
                <p:cellEditor>  
                    <f:facet name="output">  
                        <h:outputText value="#{wpis.nrWlDk}"/>
                    </f:facet>  
                    <f:facet name="input">  
                        <p:inputText value="#{wpis.nrWlDk}"/>
                    </f:facet>  
                </p:cellEditor>
            </p:column>
            <p:column id="opisColumn" headerText="opis" filterBy="#{wpis.opis}" filterMatchMode="contains" sortBy="#{wpis.nrWlDk}" >  
                <f:facet name="header">  
                    <h:outputText value="opis" />  
                </f:facet> 
                 <p:cellEditor>  
                    <f:facet name="output">  
                        <h:outputText value="#{wpis.opis}"/>
                    </f:facet>  
                    <f:facet name="input">  
                        <p:inputText value="#{wpis.opis}"/>
                    </f:facet>  
                </p:cellEditor>
            </p:column>
            <p:column id="kwotaColumn" headerText="kwota" filterBy="#{wpis.kwota}" filterMatchMode="contains" sortBy="#{wpis.kwota}">  
                <f:facet name="header">  
                    <h:outputText value="kwota" />  
                </f:facet> 
                <p:cellEditor>  
                    <f:facet name="output">  
                        <h:outputText value="#{wpis.kwota}" style="padding-left: 20%; font-weight: 700; float: right;">
                          <f:convertNumber minFractionDigits="2" locale="PL"/>
                        </h:outputText>
                    </f:facet>  
                    <f:facet name="input">  
                        <p:inputText value="#{wpis.kwota}" style="width:100%;"/>
                    </f:facet>  
                </p:cellEditor>
            </p:column>
            <p:column id="pkpirKolColumn" headerText="kolumna" filterBy="#{wpis.pkpirKol}" filterMatchMode="contains" sortBy="#{wpis.pkpirKol}">  
                <f:facet name="header">  
                    <h:outputText value="kolumna" />  
                </f:facet> 
                <h:outputText value="#{wpis.pkpirKol}" />
            </p:column>
             
            
            <p:column id="platnosci" headerText="data planosci - kwota - pozostalo ">  
                <p:dataTable var="subwpis" value="#{wpis.rozrachunki}" style="width: 400px;" emptyMessage="dokument bez płatności częściowych" >
                    <p:column id="SubColumn1" >  
                        <h:outputText value="#{subwpis.dataplatnosci}" />
                    </p:column>
                    <p:column id="SubColumn1a"  >  
                        <h:outputText value="#{subwpis.kwotawplacona}" style="float: right;">
                        <f:convertNumber minFractionDigits="2" locale="PL"/>
                        </h:outputText>
                    </p:column>
                      <p:column id="SubColumn2">  
                          <h:outputText value="#{subwpis.dorozliczenia}" style="float: right;">
                          <f:convertNumber minFractionDigits="2" locale="PL"/>
                          </h:outputText>
                    </p:column>
                </p:dataTable>
            </p:column>
             <p:column id="vatMcColumn" headerText="v m-c" filterBy="#{wpis.vatM}" filterMatchMode="contains" sortBy="#{wpis.vatM}" width="60" filterMaxLength="2">  
                <f:facet name="header">  
                    <h:outputText value="v m-c" />  
                </f:facet> 
                <h:outputText value="#{wpis.vatM}" />
            </p:column>
            <p:column id="vatRokColumn" headerText="v rok" filterBy="#{wpis.vatR}" filterMatchMode="contains" sortBy="#{wpis.vatR}" width="60" filterMaxLength="4">  
                <f:facet name="header">  
                    <h:outputText value="v rok" />  
                </f:facet> 
                <h:outputText value="#{wpis.vatR}" />
            </p:column>
            <p:column id="uwagaColumn" headerText="uwagi" filterBy="#{wpis.uwagi}" filterMatchMode="contains" sortBy="#{wpis.uwagi}">  
                <f:facet name="header">  
                    <h:outputText value="uwagi" />  
                </f:facet> 
                <h:outputText value="#{wpis.uwagi}" />
            </p:column>
            <p:column id="editColumn" headerText="edytuj">
                 <p:rowEditor />  
            </p:column>
            
            <p:column id="deleteColumn" headerText="usuń">
                <p:commandButton actionListener="#{DokTabView.destroy(wpis)}" onclick="confirmation.show()" id="delete" icon="ui-icon ui-icon-trash" type="submit" />
            </p:column>
            <p:column id="kwotaColumnX" headerText="kwota" filterBy="#{wpis.kwotaX}" filterMatchMode="contains" sortBy="#{wpis.kwotaX}">  
                <f:facet name="header">  
                    <h:outputText value="kwota" />  
                </f:facet> 
                <p:cellEditor>  
                    <f:facet name="output">  
                        <h:outputText value="#{wpis.kwotaX}" style="padding-left: 20%; font-weight: 700; float: right;">
                           <f:convertNumber minFractionDigits="2" locale="PL"/>
                        </h:outputText>
                    </f:facet>  
                    <f:facet name="input">  
                        <p:inputText value="#{wpis.kwotaX}" style="width:100%"/>
                    </f:facet>  
                </p:cellEditor>
            </p:column>
            <p:column id="pkpirKolColumnX" headerText="kolumna" filterBy="#{wpis.pkpirKolX}" filterMatchMode="contains" sortBy="#{wpis.pkpirKolX}">  
                <f:facet name="header">  
                    <h:outputText value="kolumna" />  
                </f:facet> 
                <h:outputText value="#{wpis.pkpirKolX}" />
            </p:column>
        </p:dataTable>
    </p:outputPanel>
    
</ui:composition>   

