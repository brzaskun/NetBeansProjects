<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:ft="http://primefaces.prime.com.tr/facestrace"
    xmlns:c="http://java.sun.com/jsp/jstl/core">
 
    <f:event type="preRenderView" listener="#{pdfVAT.drukujewidencje()}"/>
    <f:event type="preRenderView" listener="#{pdfVATsuma.drukuj()}"/>
    <p:panel header="firma nievatowa" rendered="#{WpisView.podatnikObiekt.vatokres.size() gt 0 ? false : true}"/>
    <p:panel header="VAT rozliczany #{WpisView.podatnikObiekt.vatokres.size() gt 0 ? WpisView.podatnikObiekt.vatokres.get(WpisView.podatnikObiekt.vatokres.size()-1).parametr : ''}" rendered="#{WpisView.podatnikObiekt.vatokres.size() gt 0 ? true : false}"/>
    <p:tabView id="akorderonbis" style="width: 1300px;" rendered="#{WpisView.podatnikObiekt.vatokres.size() gt 0 ? true : false}">
        <c:forEach  items="#{vatView.listaewidencji.values()}" var="item" varStatus="numer">
             <p:tab  title="#{item[0].nazwaewidencji}">
                 <p:commandButton value="Pdf" onsuccess="wydrukewidencje('#{WpisView.podatnikWpisu}','#{item[0].nazwaewidencji}')"/>
                 <p:separator/>
                 <p:panel id="sumka#{numer.index}">
                     <h:outputText value="suma wybranych wartości netto: "/><h:outputText value="#{vatView.suma1}" style="font-weight: bold;">
                          <f:convertNumber minFractionDigits="2" locale="PL"/>
                         </h:outputText><br/>
                         <h:outputText value="suma wybranych wartości vat:  "/><h:outputText value="#{vatView.suma2}"  style="font-weight: bold;">
                          <f:convertNumber minFractionDigits="2" locale="PL"/>
                         </h:outputText><br/>
                         <h:outputText value="suma wybranych wartości brutto:  "/><h:outputText value="#{vatView.suma3}"  style="font-weight: bold;">
                          <f:convertNumber minFractionDigits="2" locale="PL"/>
                         </h:outputText><br/>
                 </p:panel>
                 
                 <p:separator/>
                 <p:dataTable id="tabela#{numer.index}" value="#{item}" var="itemik" scrollable="true" scrollHeight="700" scrollRows="4" 
                              rowKey="#{itemik.id}" selection="#{vatView.goscwybral}" style="width: 1200px;"
                              
                              >
                     <p:column selectionMode="multiple" width="40"/>
                     <p:ajax event="rowSelectCheckbox" listener="#{vatView.sumujwybrane1()}" update=":form:akorderonbis:sumka#{numer.index}"/>
                     <p:ajax event="rowUnselectCheckbox" listener="#{vatView.odsumujwybrane1}" update=":form:akorderonbis:sumka#{numer.index}"/>
                     <p:column headerText="id" width="40" sortBy="#{itemik.id}">
                         <h:outputText value="#{itemik.id}"/>
                     </p:column>
                     <p:column headerText="data wyst." width="110" sortBy="#{itemik.dataWyst}" filterBy="#{itemik.dataWyst}" filterMatchMode="contains">
                         <h:outputText value="#{itemik.dataWyst}"/>
                     </p:column>
                     <p:column headerText="data sprzed." width="110" sortBy="#{itemik.dataSprz}" filterMatchMode="contains" filterBy="#{itemik.dataSprz}">
                         <h:outputText value="#{itemik.dataSprz}"/>
                     </p:column>
                     <p:column headerText="nr własny" width="140" sortBy="#{itemik.nrWlDk}" filterBy="#{itemik.nrWlDk}" filterMatchMode="contains">
                         <h:outputText value="#{itemik.nrWlDk}"/>
                     </p:column>
                     <p:column headerText="nazwa kontrhenta" sortBy="#{itemik.kontr}" filterBy="#{itemik.kontr}" filterMatchMode="contains">
                         <h:outputText value="#{itemik.kontr}"/>
                     </p:column>
                     <p:column headerText="opis trans." sortBy="#{itemik.opis}" filterBy="#{itemik.opis}" filterMatchMode="contains">
                         <h:outputText value="#{itemik.opis}"/>
                     </p:column>
                     <p:column headerText="netto" width="110" sortBy="#{itemik.netto}" filterBy="#{itemik.netto}" filterMatchMode="contains">
                         <h:outputText value="#{itemik.netto}" style="float: right;">
                          <f:convertNumber minFractionDigits="2" locale="PL"/>
                         </h:outputText>
                     </p:column>
                     <p:column headerText="vat" width="110" sortBy="#{itemik.vat}" filterBy="#{itemik.vat}" filterMatchMode="contains">
                         <h:outputText value="#{itemik.vat}" style="float: right;">
                          <f:convertNumber minFractionDigits="2" locale="PL"/>
                        </h:outputText>
                     </p:column>
                     <p:column headerText="rodzaj zak." width="60" >
                         <h:outputText value="#{itemik.opizw}"/>
                     </p:column>
                 </p:dataTable>
             </p:tab>
         </c:forEach>
        <p:tab title="podsumowanie">
            <p:commandButton value="Pdf" onsuccess="wydruksumavat('#{WpisView.podatnikWpisu}');"/>
                 <p:separator/>
                 <p:panel id="sumysum">
                     <h:outputText value="suma wybranych wartości netto: "/><h:outputText value="#{vatView.suma1}" style="font-weight: bold;">
                          <f:convertNumber minFractionDigits="2" locale="PL"/>
                         </h:outputText><br/>
                         <h:outputText value="suma wybranych wartości vat:  "/><h:outputText value="#{vatView.suma2}"  style="font-weight: bold;">
                          <f:convertNumber minFractionDigits="2" locale="PL"/>
                         </h:outputText><br/>
                          <h:outputText value="suma wybranych wartości brutto:  "/><h:outputText value="#{vatView.suma3}"  style="font-weight: bold;">
                          <f:convertNumber minFractionDigits="2" locale="PL"/>
                         </h:outputText><br/>
                 </p:panel>
                 <p:dataTable value="#{vatView.sumydowyswietlenia}" var="itemik" scrollable="true" scrollHeight="200" scrollRows="4" 
                              liveResize="true" selection="#{vatView.goscwybralsuma}" rowKey="#{itemik.ewidencja.nazwa}" 
                              selectionMode="multiple">
                     <f:facet name="header">
                         <h:outputText value="zestawienie ewidencji vat"/>
                     </f:facet>
                     <p:ajax event="rowSelect" listener="#{vatView.sumujwybrane()}" update=":form:akorderonbis:sumysum"/>
                     <p:column headerText="nazwa ewidencji" width="200">
                         <h:outputText value="#{itemik.ewidencja.nazwa}"/>
                     </p:column>
                     <p:column headerText="wartość netto" width="150">
                         <h:outputText value="#{itemik.netto}" style="float: right;">
                          <f:convertNumber minFractionDigits="2" locale="PL"/>
                         </h:outputText>
                     </p:column>
                     <p:column headerText="wartosć vat" width="150">
                         <h:outputText value="#{itemik.vat}"  style="float: right;">
                          <f:convertNumber minFractionDigits="2" locale="PL"/>
                         </h:outputText>
                     </p:column>
                     <p:column headerText="estawka" width="80">
                         <h:outputText value="#{itemik.estawka}"/>
                     </p:column>
                    

                 </p:dataTable>
        </p:tab>
    </p:tabView>
  
</ui:composition>   


