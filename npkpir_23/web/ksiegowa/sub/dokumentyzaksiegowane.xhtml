<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:ft="http://primefaces.prime.com.tr/facestrace"
    xmlns:pe="http://primefaces.org/ui/extensions"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:bcf="http://brzaskun.com/facelets">
    <h:outputScript name="jsf.js" library="javax.faces" target="head"/>
    <style>
        .ui-inputfield .ui-inputtext {
            padding: 0px !important;
            margin: 0px !important;
        }

        .ui-datatable-data tr td {
            padding: 0px !important;
            margin: 0px !important;
        }
/*        dzieki temu nie mamy ramek przy wpisywani danych do dokumentu*/
        .ui-inputfield, .ui-widget-content .ui-inputfield, .ui-widget-header .ui-inputfield {
            border: none;
            outline: none;
            box-shadow: none;
        }
        .ui-inputfield.ui-state-focus, .ui-widget-content .ui-inputfield.ui-state-focus, .ui-widget-header .ui-inputfield.ui-state-focus {
            -webkit-box-shadow: none;
            box-shadow: none;
            font-weight: 900;
            background: #e4e3e3;
        }
        
        
    </style>
    <h:form>
        <p:stack icon="/resources/images/menustack/stack.png" >  
            <p:menuitem global="false" value="duplikaty" icon="/resources/images/menustack/mix.png"  actionListener="#{DokTabView.sprawdzCzyNieDuplikat}"  />  
        </p:stack>
    </h:form>
    
    <h:form id="form">
        <p:contextMenu id="menutablica" for="dokumentyLista">
            <p:menuitem global="false" value="Edytuj" update=":formM:messages" icon="ui-icon-calculator" actionListener="#{DokumentView.sprawdzczywybranodokumentdoedycji}" rendered="#{!zamkniecieView.sprawdzMiesiacRok()}"/>
            <p:menuitem global="false" value="Okresowa" update=":formM:messages" icon="ui-icon-calculator" actionListener="#{fakturyokresoweView.dodajfaktureokresowa()}"/>
            <p:menuitem global="false" value="PDF" update=":formM:messages" actionListener="#{DokTabView.printPDFPK()}" icon="ui-icon-disk" onsuccess="wydrukpk('#{WpisView.podatnikWpisu}');"/>
            <p:menuitem global="false" value="Wydruk" update=":formM:messages" actionListener="#{DokTabView.printPDFPKWydruk()}" icon="ui-icon-disk" />
            <p:menuitem global="false" value="Usuń wybrane" actionListener="#{DokTabView.destroygrupa()}" icon="ui-icon-trash" onclick="PF('confirmation1').show();" update=":form:dokumentyLista" rendered="#{!zamkniecieView.sprawdzMiesiacRok()}"/>
            <p:menuitem global="false" value="Switch" update=":formM:messages" actionListener="#{DokTabView.aktywacjadeaktywacja()}" icon="ui-icon-locked" rendered="#{facesContext.externalContext.remoteUser eq 'szef'}"/>
        </p:contextMenu>
        <script>
            //dzieki tej genialnej funkcji wie na ktorym rowku kliknelismy i od tego zacyzn alazenie
             /* <![CDATA[ */
               $(document).on("click", '.grid tr', function(e) {
               var listawierszy = $("#form\\:dokumentyLista_data").children("tr");
               var lppierwszywiersz = $(listawierszy[0]).find(".lpwiersza").text();
               try {
                   e.stopPropagation(); // will prevent double click events from link being clicked within row
                   var lpwiersznast = $.trim($(this).closest("tr").find(".lpwiersza").text()); // trim to remove end space, closest gets closest parent of selected type
                   var numerwiersza = lpwiersznast- lppierwszywiersz;
                   zachowajnumerwiersza(numerwiersza);
               } catch (e) {
                   alert('error');
               }
               });
               
             /* ]]> */
        </script>
        <p:hotkey bind="down"  onstart="przejdzwiersz();"/>
         <p:hotkey bind="up"   onstart="wrocwiersz();"/>
         <p:outputPanel id="kontenertabeli" deferred="true">
             <p:dataTable  var="wpis" value="#{DokTabView.obiektDOKmrjsfSel}" id="dokumentyLista"  filteredValue="#{DokTabView.dokumentyFiltered}"
                           style="max-width: 1300px; height: 900px; overflow-y: scroll;" rowKey="#{wpis.idDok}" selection="#{DokTabView.gosciuwybral}" widgetVar="dokTable"
                          rowStyleClass="#{wpis.rodzTrans eq 'sprzedaz' ? 'old' : (wpis.netto lt 0 ? 'korekta' : null)}" emptyMessage="W danym miesiącu nie było żadnych zapisów"
                          selectionMode="multiple" styleClass="grid" 
                          >
                <p:ajax event="rowSelect"  listener="#{DokumentView.skopiujdoedycji()}"/>
                <f:facet name="header">  
                        <h:outputText value="Zestawienie #{DokTabView.obiektDOKmrjsfSel.size()} zaksięgowanych w miesiącu '#{WpisView.miesiacWpisu}' dokumentów " />  
                    <h:outputText value="- wyszukiwanie: " />  
                    <p:inputText id="globalFilter" onkeyup="PF('dokTable').filter()" style="width:250px" placeholder="wyszukiwane wyrażenie" />  
                    <p:commandButton id="toggler" type="button" value="Kolumny" style="float:right" icon="ui-icon-calculator" />
                    <p:columnToggler datasource="dokumentyLista" trigger="toggler" />
                </f:facet>

                <p:column style="width: 10px; height: 45px; text-align: center;" >
                    <p:rowToggler rendered="#{wpis.ewidencjaVAT1.size() gt 0}"/>
                    <h:outputText value="bez VAT" rendered="#{wpis.ewidencjaVAT1.size() eq null}"/>
                </p:column>
                <p:column id="idColumn" headerText="#{mgs.numerkolejny}" sortBy="#{wpis.nrWpkpir}"  style="width: 20px; text-align: center;">  
                    <h:outputText styleClass="lpwiersza" value="#{wpis.nrWpkpir}" />
                </p:column>
                <p:column id="dataColumn" headerText="data wyst" filterBy="#{wpis.dataWyst}" filterStyle="display : none;" filterMatchMode="contains" sortBy="#{wpis.dataWyst}"  style="width: 50px; min-width: 70px;">  
                    <h:outputText value="#{wpis.dataWyst}"/>
                </p:column>
                <p:column id="kontrColumn" headerText="#{mgs.kontrahent}" filterBy="#{wpis.kontr.npelna}" filterStyle="display : none;" filterMatchMode="contains" sortBy="#{wpis.kontr.npelna}" style="width: 14%;">  
                    <h:outputText style="font-weight: bold;" value="#{wpis.kontr.npelna}"  />
                    <h:outputText value=" #{wpis.kontr.miejscowosc} - NIP #{wpis.kontr.nip}"  rendered="#{!(wpis.kontr.nip eq '0000000000')}"/>
                    <h:outputText value=" #{wpis.kontr.miejscowosc}"  rendered="#{wpis.kontr.nip eq '0000000000'}"/>
                </p:column>
                <p:column id="rodzTrColumn" headerText="rodzaj trans" filterBy="#{wpis.typdokumentu}" filterStyle="display : none;" filterMatchMode="contains" sortBy="#{wpis.typdokumentu}"  style="width: 5%;text-align: center;">  
                    <h:outputText value="#{wpis.typdokumentu}"/>
                </p:column>
                <p:column id="nrWlDokColumn" headerText="nr wł" filterBy="#{wpis.nrWlDk}" filterStyle="display : none;" filterMatchMode="contains" sortBy="#{wpis.nrWlDk}"  style="width: 10%;" >   
                    <h:outputText value="#{wpis.nrWlDk}" />
                </p:column>
                <p:column id="opisColumn" headerText="#{mgs.opis}" filterBy="#{wpis.opis}" filterStyle="display : none;" filterMatchMode="contains" sortBy="#{wpis.opis}" style="width: 10%;">  
                    <h:outputText value="#{wpis.opis}"/>
                </p:column>
                <p:column id="nettoColumn" headerText="#{mgs.netto}" filterBy="#{wpis.netto}" filterStyle="display : none;" filterMatchMode="contains" sortBy="#{wpis.netto}"  style="width: 60px;">  
                    <h:outputText value="#{wpis.netto}" style="float: right;">
                        <f:convertNumber minFractionDigits="2" locale="PL"/>
                    </h:outputText>
                </p:column>

                <p:column id="pkpirKolColumn" headerText="zapis w pkpir" style="width: 14%;" resizable="true" >
                    <ui:repeat value="#{wpis.listakwot1}" var="item" varStatus="nr">
                        <h:outputText value="#{wpis.listakwot1.get(nr.index).netto}" style="float: right;">
                                <f:convertNumber minFractionDigits="2" locale="PL"/>
                            </h:outputText>
                            <h:outputText value="#{wpis.listakwot1.get(nr.index).nazwakolumny}" style="float: left;">
                                <f:convertNumber minFractionDigits="2" locale="PL"/>
                            </h:outputText><br/>
                        </ui:repeat>
                </p:column>
                <p:rowExpansion>
                    <p:column id="ewidencjavat" headerText="ewidencjavat - netto - vat - op/zw" width="300" resizable="true">  
                        <p:dataTable var="subwpis" value="#{wpis.ewidencjaVAT1}" emptyMessage="dokument bez vat"  resizableColumns="true" style="width: 50%;">
                            <p:column id="SubColumn1" headerText="ewidencja">  
                                <h:outputText value="#{subwpis.ewidencja.nazwa}" rendered="#{subwpis.vat ne 0 ? true : subwpis.netto ne 0 ? true : false}" />
                            </p:column>
                            <p:column id="SubColumn1a"  headerText="#{mgs.netto}">  
                                <h:outputText value="#{subwpis.netto}" style="float: right;" rendered="#{subwpis.vat ne 0 ? true : subwpis.netto ne 0 ? true : false}">
                                    <f:convertNumber minFractionDigits="2" locale="PL"/>
                                </h:outputText>
                            </p:column>
                            <p:column id="SubColumn2" headerText="#{mgs.VAT}">  
                                <h:outputText value="#{subwpis.vat}" style="float: right;" rendered="#{subwpis.vat ne 0 ? true : subwpis.netto ne 0 ? true : false}">
                                    <f:convertNumber minFractionDigits="2" locale="PL"/>
                                </h:outputText>
                            </p:column>
                            <p:column id="SubColumn2a" headerText="brutto">  
                                <h:outputText value="#{subwpis.netto + subwpis.vat}" style="float: right;" rendered="#{subwpis.vat ne 0 ? true : subwpis.netto ne 0 ? true : false}">
                                    <f:convertNumber minFractionDigits="2" locale="PL"/>
                                </h:outputText>
                            </p:column>
                            <p:column id="SubColumn3" headerText="op/zw">  
                                <h:outputText value="#{subwpis.estawka}" rendered="#{subwpis.vat ne 0 ? true : subwpis.netto ne 0 ? true : false}"/>
                            </p:column>
                            <p:column id="SubColumn4" headerText="okresy vat">  
                                <h:outputText value="#{wpis.vatM}/#{wpis.vatR}" style="float: right;" rendered="#{subwpis.vat ne 0 ? true : subwpis.netto ne 0 ? true : false}"/>
                            </p:column>
                        </p:dataTable>
                    </p:column>
                </p:rowExpansion>
                <p:column id="vatMcColumn" headerText="#{mgs.VAT}" filterBy="#{wpis.vatM}" filterStyle="display : none;" filterMatchMode="contains" sortBy="#{wpis.vatM}"  style="width: 14px; text-align: center;" filterMaxLength="2">  
                    <h:outputText style="#{wpis.vatM eq wpis.pkpirM ? null : 'font-weight: bold; color: red;'}" value="#{wpis.vatM}"/>
                </p:column >
                <p:column id="status" headerText="status"  style="width: 5%; text-align: center;">
                    <h:outputText value="#{wpis.status}"/>
                </p:column>
                <p:column id="deleteColumn" headerText="usuń" style="width: 5%; text-align: center;">
                    <p:commandButton actionListener="#{DokTabView.destroy(wpis)}" onclick="PF('confirmation').show()" id="delete" icon="ui-icon ui-icon-trash" type="submit" rendered="#{wpis.status eq 'bufor' ? true : false}" />
                </p:column>
                <p:column id="usunpozornieColumn" headerText="mod" sortBy="#{wpis.usunpozornie}"  style="width: 5%; text-align: center;" rendered="#{facesContext.externalContext.remoteUser eq 'szef'}">  
                    <h:outputText value="#{wpis.usunpozornie}" />
                </p:column>

            </p:dataTable>
        </p:outputPanel>
    </h:form>
    <!--EDYCJA faktur z tabeli-->
    <p:dialog id="dialogEdycja" header="Dane dokumentu:" widgetVar="dialogEdycjaZaksiegowanychDokumentow" resizable="false"  >
        <h:form id="dodWiad">
              <p:commandButton id="dodkol" value="F8" actionListener="#{DokumentView.dodajwierszpkpir()}" update=":dodWiad:tabelapkpir" oncomplete="aktywujnetto()" accesskey="p" style="display: none;"/>
                <p:commandButton id="usunkol" value="F8" actionListener="#{DokumentView.usunwierszpkpir()}" update=":dodWiad:tabelapkpir" oncomplete="aktywujnetto()" accesskey="p" style="display: none;"/>
            <p:panel menuTitle="Wprowadzanie dokumentów klient" header="Edytowanie zaksięgowanego dokumentu klienta: #{WpisView.podatnikWpisu} okres: #{WpisView.rokWpisu}/#{WpisView.miesiacWpisu}"
                     style="width: 1100px; min-height: 450px;" id="wprowadzanie">
                <p:growl id="mess_add" />
                <p:focus for="polawprowadzania"/>
                <p:panelGrid id="polawprowadzania" columns="6" >
                    <h:outputLabel value="data wystawienia" style="font-weight: 700"/>
                    <h:outputLabel value="data sprzedaży" style="font-weight: 700"/>
                    <h:outputLabel value="#{mgs.kontrahent}" style="font-weight: 700"/>
                    <h:outputLabel value="rodzaj dok" style="font-weight: 700"/>
                    <h:outputLabel value="nr własny" style="font-weight: 700;"/>
                    <h:outputLabel value="opis transakcji (F9)/nowa kol (F8)" style="font-weight: 700"/>


                    <p:inputText id="dataPole" value="#{DokumentView.selDokument.dataWyst}"   accesskey="s" maxlength="10" style="width: 120px" size="10"  required="true" requiredMessage="Pole daty nie może byc puste" immediate="false"  onblur="ustawDate(#{WpisView.rokWpisu},#{WpisView.miesiacWpisu});" title="wpisz numer dania, lub miesiąc i dzień" >
                    </p:inputText>
                    <p:inputText id="dataSPole" value="#{DokumentView.selDokument.dataSprz}" maxlength="10" style="width: 100px" onblur="ustawDateSprzedazy(#{WpisView.rokWpisu},#{WpisView.miesiacWpisu});" required="true" requiredMessage="Pole daty sprzedaży nie może byc puste" />
                    <h:panelGroup id="dwadoWprowadzania" >
                        <p:autoComplete id="acForce" value="#{DokumentView.selDokument.kontr}" completeMethod="#{KlView.complete}"
                                        var="p" itemLabel="#{p.npelna}" itemValue="#{p}" converter="KlientConv" title="wpisz nazwę lub nip kontrahenta"
                                        minQueryLength="3" maxResults="10" maxlength="10" converterMessage="Nieudana konwersja Klient"
                                        autocomplete="true" forceSelection="true"
                                        required="true" requiredMessage="Pole klienta nie może byc puste" queryDelay="10" >
                            <p:ajax event="keyup" partialSubmit="true"/>
                            <f:facet name="itemtip">  
                                <h:panelGrid  columns="2" cellpadding="5" width="400">  
                                    <f:facet name="header">  
                                        <h:outputText value="Dane kontrahenta"/>
                                    </f:facet>  
                                    <h:outputText value="Nazwa: " />  
                                    <h:outputText id="npelna" value="#{p.npelna}" />  
                                    <h:outputText value="NIP: " />  
                                    <h:outputText id="nip" value="#{p.nip}" />  
                                    <h:outputText value="Adres " />  
                                    <h:outputText id="klumna" value="#{p.miejscowosc} #{p.ulica} #{p.dom} #{p.lokal}" /> 
                                </h:panelGrid>
                            </f:facet>
                            <f:param name="passedValue" value="#{p}" />
                        </p:autoComplete>
                    </h:panelGroup>
                    <h:selectOneMenu id="rodzajTrans" value="#{DokumentView.typdokumentu}"   style="width: 180px;" required="true" title="wybierz rodzaj księgowanego dokumentu"
                                     styleClass="ui-selectonemenu-label ui-inputfield ui-corner-all"
                                 onfocus="$(this).addClass('ui-state-focus');"
                                 onblur="$(this).removeClass('ui-state-focus');">
                        <f:selectItems value="#{DokumentView.rodzajedokKlienta}" var="loop" itemLabel="#{loop.rodzajedokPK.skrotNazwyDok} - #{loop.nazwa}" itemValue="#{loop.rodzajedokPK.skrotNazwyDok}"/>
                        <p:ajax event="keyup" listener="#{DokumentView.pobierzwprowadzonynumer()}"/>
                        <p:ajax event="blur" listener="#{DokumentView.podepnijListe()}"  update="dodWiad:tabelapkpir" />
                        <p:ajax event="blur" listener="#{DokumentView.wygenerujnumerkolejny()}" update=":dodWiad:numerwlasny" oncomplete="aktywujopis();"/>
                    </h:selectOneMenu> 
                    <p:inputText id="numerwlasny" value="#{DokumentView.selDokument.nrWlDk}" title="wpisz numer własny faktury">
                    </p:inputText>

                    <p:autoComplete id="opis" value="#{DokumentView.selDokument.opis}" completeMethod="#{Opis.complete}"
                                    var="p" itemLabel="#{p}" itemValue="#{p}"  title="wpisz opis faktury"
                                    minQueryLength="2" maxResults="10" maxlength="40"
                                    effect="clip" autocomplete="true"  required="true" requiredMessage="Brak opisu transakcji - uzupełnij" queryDelay="1" style="width: 200px;">
                        <p:ajax event="itemSelect" partialSubmit="true" global="false"/>
                    </p:autoComplete>

                </p:panelGrid>
                <p:commandButton id="dodajopis" value="ok" actionListener="#{Opis.dodajOpis}" style="display: none;"/>
                <!--        <span id="log"></span>-->


                <script>
                    /* <![CDATA[ */
                    $(function() {
                        try {
                        $("#dodWiad\\:tabelapkpir\\:1\\:kwotaPkpir_input").on('keyup', function(e) {
                            var roznica;
                            if (e.which == 107) {
                                var odjema = zrobFloat($(this).val());
                                var odjemna = zrobFloat($("#dodWiad\\:tabelapkpir\\:0\\:kwotaPkpir_input").val());
                                roznica = odjemna - odjema;
                                $(this).val(Math.abs(roznica));
                                e.stopImmediatePropagation();
                            }
                        })
                    } catch (ex){}

                    })
                            /* ]]> */
                </script>
                <!-- kolumny podatkowej ksiegi przychodow i rozchodow-->
            <p:panelGrid columns="2" style="width: 100%;" columnClasses="forty-percent, sixty-percent">
              <p:dataTable id="tabelapkpir" value="#{DokumentView.selDokument.listakwot1}" var="row" emptyMessage="jeszcze nie wygenerowano kolumny" >
                    <p:column headerText="kwota faktury netto">
                        <pe:inputNumber id="kwotaPkpir" value="#{row.netto}" symbol=" zł" required="true" requiredMessage="Brak kwoty - uzupełnij" style="text-align: right;" symbolPosition="s" decimalSeparator="." thousandSeparator=" " decimalPlaces="2" minValue="-10000000" styleClass="wiersznetto" > 
                            <p:ajax event="blur" listener="#{DokumentView.dokumentEwidencjaVAT}" global="false" oncomplete="dolaczwyliczenieKopiowanie();"/>
                        </pe:inputNumber>
                    </p:column>
                    <p:column headerText="kolumna pkpir">
                        <h:selectOneMenu id="kolumnaPkpir" value="#{row.nazwakolumny}"  styleClass="ui-selectonemenu-label ui-inputfield ui-corner-all"
                                         onfocus="$(this).addClass('ui-state-focus');"
                                        onblur="$(this).removeClass('ui-state-focus');">
                            <f:selectItems value="#{DokumentView.kolumny}"/>
                        </h:selectOneMenu><br/>
                    </p:column>
                </p:dataTable>
                <p:dataTable id="tabelapkpir2" value="#{DokumentView.selDokument}" var="item" >
                    <p:column headerText="dok. prosty" style="text-align: center;" width="60">
                        <h:selectBooleanCheckbox id="dokumentprosty" value="#{item.dokumentProsty}" >
                            <p:ajax event="click" listener="#{DokumentView.dokumentEwidencjaVAT()}" global="false"/>
                        </h:selectBooleanCheckbox>
                    </p:column>
                    <p:column headerText="rozliczony" style="text-align: center;" width="60">
                        <h:selectBooleanCheckbox id="rozliczony" value="#{item.rozliczony}" onchange="przekazdate()"  >
                        </h:selectBooleanCheckbox>
                    </p:column>
                    <p:column headerText="termin płatności">
                        <p:inputText id="dataTPole" value="#{item.terminPlatnosci}" maxlength="10"  required="true" requiredMessage="Brakuje terminu platnosci" title="wpisz pełny termin płatności">
                        </p:inputText>
                    </p:column>
                    <p:column headerText="wartość dokumentu">
                        <pe:inputNumber id="sumbrutto" value="#{DokumentView.sumbrutto}" symbol=" zł" required="true" requiredMessage="Brak kwoty - uzupełnij" style="text-align: right;" symbolPosition="s" decimalSeparator="." thousandSeparator=" " decimalPlaces="2" minValue="-10000000" styleClass="wiersznetto"/> 
                    </p:column>
                    <p:column headerText="inwestycja">
                        <h:selectOneMenu id="inwestycja" value="#{item.symbolinwestycji}" style="display: none;">
                            <f:selectItems value="#{inwestycjeView.inwestycjesymbole}"/>
                        </h:selectOneMenu>
                    </p:column>
                </p:dataTable>
            </p:panelGrid>    
            
                <p:panel id="panelewidencji" style="width: 300px;">
                    <p:dataTable  var="wpis" value="#{STRTableView.srodkiTrwale}" id="srodkiLista" editable="true" rendered="#{DokumentView.pokazEST}"
                                  paginator="true" paginatorAlwaysVisible="true" rows="6"
                                  paginatorTemplate="{FirstPageLink} {PageLinks} {LastPageLink} {RowsPerPageDropdown}" 
                                  rowsPerPageTemplate="6,12,18,24,32,50" style="width: 1500px; "
                                  rowKey="#{wpis.id}" selection="#{sTRSprzedazView.wybranesrodkitrwale}"> 

                        <f:facet name="header">  
                            <h:outputText value="Ewidencja srodkow trwalych" />  
                        </f:facet>
                        <p:column selectionMode="multiple"/>
                        <p:column id="idColumn" headerText="nr kolejny" width="40">  
                            <h:outputText value="#{wpis.nrsrodka}" style="#{wpis.styl}"/>
                        </p:column>
                        <p:column id="dataColumn" headerText="data zak" filterBy="#{wpis.datazak}" filterMatchMode="contains" sortBy="#{wpis.datazak}" width="80">  
                            <h:outputText value="#{wpis.datazak}" style="#{wpis.styl}">
                                <f:convertDateTime dateStyle="medium"  />
                            </h:outputText>
                        </p:column>
                        <p:column id="data2Column" headerText="data przek" filterBy="#{wpis.dataprzek}" filterMatchMode="contains" sortBy="#{wpis.dataprzek}" width="80">  
                            <h:outputText value="#{wpis.dataprzek}" style="#{wpis.styl}">
                                <f:convertDateTime dateStyle="medium"  />
                            </h:outputText>
                        </p:column>
                        <p:column id="nazwaColumn" headerText="nazwa" filterBy="#{wpis.nazwa}" filterMatchMode="contains" sortBy="#{wpis.nazwa}" >  
                            <h:outputText value="#{wpis.nazwa}"  style="#{wpis.styl}" />
                        </p:column>
                        <p:column id="kstColumn" headerText="KŚT" filterBy="#{wpis.kst}" filterMatchMode="contains" sortBy="#{wpis.kst}" width="50">  
                            <h:outputText value="#{wpis.kst}"  style="#{wpis.styl}" />
                        </p:column>
                        <p:column id="dowColumn" headerText="nr.fakt" filterBy="#{wpis.nrwldokzak}" filterMatchMode="contains" sortBy="#{wpis.nrwldokzak}" width="50">  
                            <h:outputText value="#{wpis.nrwldokzak}" style="#{wpis.styl}"  />
                        </p:column>
                        <p:column id="rodzTrColumn" headerText="#{mgs.kwota}" filterBy="#{wpis.netto}" filterMatchMode="contains" sortBy="#{wpis.netto}">  
                            <h:outputText value="#{wpis.netto}" style="float: right; #{wpis.styl}">
                                <f:convertNumber minFractionDigits="2" locale="PL"/>
                            </h:outputText>
                        </p:column>
                        <p:column id="vatColumn" headerText="umorz.pocz" filterBy="#{wpis.umorzeniepoczatkowe}" filterMatchMode="contains" sortBy="#{wpis.umorzeniepoczatkowe}">  
                            <h:outputText value="#{wpis.umorzeniepoczatkowe}" style="float: right; #{wpis.styl}">
                                <f:convertNumber minFractionDigits="2" locale="PL"/>
                            </h:outputText>
                        </p:column>
                        <p:column id="stawkaColumn" headerText="odpis stawka" filterBy="#{wpis.stawka}" filterMatchMode="contains" sortBy="#{wpis.stawka}" width="50">  

                            <h:outputText value="#{wpis.stawka}%" style="#{wpis.styl}">
                                <f:convertNumber maxFractionDigits="2"
                                                 groupingUsed="true"
                                                 maxIntegerDigits="5"
                                                 type="number"/>
                            </h:outputText>
                        </p:column>
                        <p:column id="odpisrokColumn" headerText="odpis rok" filterBy="#{wpis.odpisrok}" filterMatchMode="contains" sortBy="#{wpis.odpisrok}" width="90">  
                            <h:outputText value="#{wpis.odpisrok}" style="float: right; #{wpis.styl}">
                                <f:convertNumber minFractionDigits="2" locale="PL"/>
                            </h:outputText>
                        </p:column>
                        <p:column id="odpismcColumn" headerText="wyksiegowany" filterBy="#{wpis.odpismc}" filterMatchMode="contains" sortBy="#{wpis.odpismc}" width="90">  
                            <h:outputText value="#{wpis.datasprzedazy}" style="float: right; #{wpis.styl}">
                            </h:outputText>
                        </p:column>
                    </p:dataTable>
                    <p:separator/>

                </p:panel>
                <!--pola ewidencji SRODKOW TRWALYCH-->
                <p:panel id="panelwyszukiwarki" style="width: 300px;" >
                    <p:panel header="wyszukiwarka środka trw." style="width: 300px;" rendered="#{DokumentView.renderujwysz}"/>
                    <p:autoComplete id="acForce1" value="#{DokumentView.srodekkategoria}" completeMethod="#{srodkikstView.complete}"
                                    var="pa" itemLabel="#{pa.nazwa}" itemValue="#{pa}"  converter="SrodkiConv"
                                    minQueryLength="3" maxResults="15" maxlength="15" itemtipMyPosition="rightbottom"
                                    queryDelay="100" size="50" valueChangeListener="#{DokumentView.skopiujSTR()}" rendered="#{DokumentView.renderujwysz}">
                        <p:ajax event="blur" async="true" oncomplete="dataprzyjecia();"/>
                        <f:facet name="itemtip">  
                            <h:panelGrid  columns="2" cellpadding="5" width="400" >  
                                <f:facet name="header">  
                                    <h:outputText value="Dane środka trwałego"/>
                                </f:facet>  
                                <h:outputText value="Nazwa: " />  
                                <h:outputText id="npelna1" value="#{pa.nazwa}"/>  
                                <h:outputText value="Stawka " />  
                                <h:outputText id="nip1" value="#{pa.stawka}" />  
                                <h:outputText value="KŚT " />  
                                <h:outputText id="klumna1" value="#{pa.symbol}" /> 
                            </h:panelGrid>
                        </f:facet>
                    </p:autoComplete>
                </p:panel>
                <p:panel id="nowypanelsrodki" style="width: 79%; margin-left: -1%;">
                <p:dataTable id="tabelasrodkitrwaleOT" value="#{DokumentView.selectedSTR}" var="loops" rendered="#{DokumentView.renderujwysz}"> 
                    <p:column headerText="nazwa środka">
                        <h:inputText id="nazwasrodka" value="#{loops.nazwa}"/>
                    </p:column>
                     <p:column headerText="data przyjecia">
                         <h:inputText id="dataprz" value="#{loops.dataprzek}" onblur="ustawDateSrodekTrw();"/>
                    </p:column>
                    <p:column headerText="symbol KST">
                         <h:inputText value="#{loops.kst}"/>
                    </p:column>
                    <p:column headerText="stawka amort">
                         <h:inputText value="#{loops.stawka}"/>
                    </p:column>
                    <p:column headerText="dotychczasowe umorzenie">
                         <h:inputText value="#{loops.umorzeniepoczatkowe}"/>
                    </p:column>
                    <p:column headerText="nie podlega umorzeniu">
                         <h:inputText value="#{loops.niepodlegaamortyzacji}"/>
                    </p:column>
                    <p:column headerText="środek trw/wyposazenie">
                        <h:selectOneMenu value="#{loops.typ}">
                            <f:selectItem itemLabel="srodek trw." itemValue="srodek trw."/>
                            <f:selectItem itemLabel="wyposazenie" itemValue="wyposazenie"/>
                        </h:selectOneMenu>
                    </p:column>
                </p:dataTable>
            </p:panel>
            
<!--                alternatywne pola ewidencji vat-->
        <p:panel id="panelewidencjivat" >
                <!--                alternatywne pola ewidencji vat-->
                <p:dataTable id="tablicavat" value="#{DokumentView.ewidencjaAddwiad}" var="item" emptyMessage="nie ma zapisów w ewidencji vat" style="width: 90%;" rendered="#{!DokumentView.ukryjEwiencjeVAT}">
                    <p:column headerText="rodzaj ewidencji" style="width: 25%;">
                        <h:outputText value="#{item.opis}"/>
                    </p:column>
                    <p:column headerText="#{mgs.netto}" style="width: 20%;">
                        <pe:inputNumber id="netto" value="#{item.netto}" symbol=" zł" required="true" requiredMessage="Brak kwoty - uzupełnij" style="text-align: right;" symbolPosition="s" decimalSeparator="." thousandSeparator=" " decimalPlaces="2" minValue="-10000000" styleClass="wiersznetto"> 
                            <p:ajax event="change" listener="#{DokumentView.updatenetto(item)}" />
                        </pe:inputNumber>
                    </p:column>
                    <p:column headerText="#{mgs.VAT}" style="width: 20%;">
                        <pe:inputNumber id="vat" value="#{item.vat}" symbol=" zł" required="true" requiredMessage="Brak kwoty - uzupełnij" style="text-align: right;" symbolPosition="s" decimalSeparator="." thousandSeparator=" " decimalPlaces="2" minValue="-10000000" styleClass="wiersznetto"> 
                            <p:ajax event="change" listener="#{DokumentView.updatevat(item)}" />
                        </pe:inputNumber>
                    </p:column>
                    <p:column headerText="brutto" style="width: 20%;">
                        <pe:inputNumber id="brutto" value="#{item.brutto}" symbol=" zł" required="true" requiredMessage="Brak kwoty - uzupełnij" style="text-align: right;" symbolPosition="s" decimalSeparator="." thousandSeparator=" " decimalPlaces="2" minValue="-10000000" styleClass="wiersznetto"/> 
                    </p:column>
                    <p:column headerText="op/zw" style="width: 15%;">
                        <h:selectOneMenu value="#{item.opzw}" styleClass="ui-selectonemenu-label ui-inputfield ui-corner-all"
                                 onfocus="$(this).addClass('ui-state-focus');"
                                 onblur="$(this).removeClass('ui-state-focus');">
                            <f:selectItem itemLabel="sprz.op" itemValue="sprz.op"/>
                            <f:selectItem itemLabel="sprzed.op.izw." itemValue="sprzed.op.izw."/>
                        </h:selectOneMenu>
                    </p:column>
                </p:dataTable>
             </p:panel>

                    <!--pola ewidencji VAT-->
                <p:panelGrid columns="4">
                    <h:outputLabel value="v m-c" style="font-weight: 700"/>
                    <h:outputLabel value="v rok" style="font-weight: 700"/>
                    <h:outputLabel value="uwagi" style="font-weight: 700"/>
                    <h:outputLabel value=""/>

                    
                     <h:selectOneMenu id="vatm" value="#{DokumentView.selDokument.vatM}">
                    <f:selectItems value="#{Mce.mceList}"/>
                </h:selectOneMenu>
                <h:selectOneMenu id="rokm" value="#{DokumentView.selDokument.vatR}">
                    <f:selectItems value="#{Roki.rokiList}"/>
                </h:selectOneMenu>
                    <h:inputText value="#{DokumentView.selDokument.uwagi}" />
                    <p:commandButton id="wprowadzenieNowego" accesskey="w" actionListener="#{DokumentView.dodaj(2)}" value="Edytuj"  style="width: 150px;" update=":form:dokumentyLista, :dodWiad" oncomplete="PF('dialogEdycjaZaksiegowanychDokumentow').hide();"> 
                    </p:commandButton>
                </p:panelGrid>
            </p:panel>
        </h:form>

    </p:dialog>
</ui:composition>   

