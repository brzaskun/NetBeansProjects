<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:ft="http://primefaces.prime.com.tr/facestrace"
    xmlns:pe="http://primefaces.org/ui/extensions"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:bcf="http://brzaskun.com/facelets">
    <style>
        .ui-inputfield .ui-inputtext {
            padding: 0px !important;
            margin: 0px !important;
        }

        .ui-datatable-data tr td {
            padding: 0px !important;
            margin: 0px !important;
        }
        /*        dzieki temu nie mamy ramek przy wpisywani danych do dokumentu*/
        .ui-inputfield, .ui-widget-content .ui-inputfield, .ui-widget-header .ui-inputfield {
            border: none;
            outline: none;
            box-shadow: none;
        }
        .ui-inputfield.ui-state-focus, .ui-widget-content .ui-inputfield.ui-state-focus, .ui-widget-header .ui-inputfield.ui-state-focus {
            -webkit-box-shadow: none;
            box-shadow: none;
            background: #e4e3e3;
        }


    </style>
    
    <h:form id="form_dokument_wpis_platnosci">
        <p:dataTable  var="wpis" value="#{platnosciWalutyView.dokumenty}" id="dokumentyLista"  filteredValue="#{platnosciWalutyView.dokumentyFiltered}" rowIndexVar="index"
                      style="width: 1200px; margin-top: 10px; overflow-y: scroll; height: 400px;" rowKey="#{wpis.idDok}" selection="#{platnosciWalutyView.selected}" widgetVar="dokTable"
                      rowStyleClass="#{wpis.rodzTrans eq 'sprzedaz' ? 'old' : (wpis.netto lt 0 ? 'korekta' : null)}"
                          emptyMessage="W danym miesiącu nie było żadnych zapisów"
                          selectionMode="single" styleClass="grid" 
                          >
            <p:ajax event="rowSelect"  listener="#{platnosciWalutyView.pobierzplatnosci()}" update="form_dokument_wpis_platnosci1 form_dokument_wpis_platnosci2:dokumentyLista1"/>
                <f:facet name="header">  
                    <h:outputText value="Zestawienie #{platnosciWalutyView.dokumenty.size()} zaksięgowanych w miesiącu '#{WpisView.miesiacWpisu}' dokumentów walutowych " />  
                    <h:outputText value="- wyszukiwanie: " />  
                    <p:inputText id="globalFilter" onkeyup="PF('dokTable').filter()" style="width:250px" placeholder="wyszukiwane wyrażenie" />  
               </f:facet>
                <p:column id="idColumn" headerText="#{mgs.numerkolejny}" style="width: 20px; text-align: center;">  
                    <h:outputText styleClass="lpwiersza" value="#{index+1}" />
                </p:column>
                <p:column id="dataColumn" headerText="data wyst" filterBy="#{wpis.dataWyst}" filterStyle="display : none;" filterMatchMode="contains" sortBy="#{wpis.dataWyst}"  style="width: 50px; min-width: 70px;">  
                    <h:outputText value="#{wpis.dataWyst}"/>
                </p:column>
                <p:column id="kontrColumn" headerText="#{mgs.kontrahent}" filterBy="#{wpis.kontr.npelna}" filterStyle="display : none;" filterMatchMode="contains" sortBy="#{wpis.kontr.npelna}" style="width: 14%;">  
                    <f:facet name="filter">
                        <p:selectOneMenu onchange="PF('dokTable').filter()" style="width: 200px;">
                            <f:selectItem itemLabel="kontrahent" itemValue="#{null}" />
                            <f:selectItems value="#{platnosciWalutyView.kontrahentypodatnika}" />
                        </p:selectOneMenu>
                    </f:facet>
                    <h:outputText style="font-weight: bold;" value="#{wpis.kontr.npelna}"  />
                    <h:outputText value=" #{wpis.kontr.miejscowosc} - NIP #{wpis.kontr.nip}"  rendered="#{!(wpis.kontr.nip eq '0000000000')}"/>
                    <h:outputText value=" #{wpis.kontr.miejscowosc}"  rendered="#{wpis.kontr.nip eq '0000000000'}"/>
                </p:column>
                <p:column id="rodzTrColumn" headerText="trans" filterBy="#{wpis.typdokumentu}" filterStyle="display : none;" filterMatchMode="contains" sortBy="#{wpis.typdokumentu}"  style="width: 5%;text-align: center;">
                    <f:facet name="filter">
                        <p:selectOneMenu onchange="PF('dokTable').filter()" style="width: 60px">
                            <f:selectItem itemLabel="dok" itemValue="#{null}" />
                            <f:selectItems value="#{platnosciWalutyView.dokumentypodatnika}" />
                        </p:selectOneMenu>
                    </f:facet>
                    <h:outputText value="#{wpis.typdokumentu}"/>
                </p:column>
                <p:column id="nrWlDokColumn" headerText="nr wł" filterBy="#{wpis.nrWlDk}" filterStyle="display : none;" filterMatchMode="contains" sortBy="#{wpis.nrWlDk}"  style="width: 10%;" >   
                    <h:outputText value="#{wpis.nrWlDk}" />
                </p:column>
                <p:column id="opisColumn" headerText="#{mgs.opis}" filterBy="#{wpis.opis}" filterStyle="display : none;" filterMatchMode="contains" sortBy="#{wpis.opis}" style="width: 10%;">  
                    <h:outputText value="#{wpis.opis}"/>
                </p:column>
                <p:column id="nettoColumn" headerText="#{mgs.netto}" rendered="#{platnosciWalutyView.skrotwalutywdokum.size() gt 0 and platnosciWalutyView.skrotwalutywdokum.get(0) ne 'PLN'}"
                          filterBy="#{wpis.symbolWaluty}" filterMatchMode="contains"  sortBy="#{wpis.symbolWaluty}"  style="width: 60px;">  
                    <f:facet name="filter">
                        <p:selectOneMenu onchange="PF('dokTable').filter()" >
                            <f:selectItem itemLabel="wszyst" itemValue="#{null}" noSelectionOption="true"/>
                            <f:selectItems value="#{platnosciWalutyView.skrotwalutywdokum}" />
                        </p:selectOneMenu>
                    </f:facet>
                    <bcf:outputpl value="#{wpis.netto}"/>
                    <br/>
                   <bcf:outputpl value="#{wpis.nettoWaluta}" rendered="#{wpis.symbolWaluty ne 'PLN'}"/> 
                    <h:outputText value="#{wpis.symbolWaluty}" rendered="#{wpis.symbolWaluty ne 'PLN'}"/>
                </p:column>
                <p:column id="nettoColumn1" headerText="#{mgs.netto}" styleClass="filter40"
                          filterBy="#{wpis.netto}" filterMatchMode="contains"  sortBy="#{wpis.netto}"  style="width: 60px;">  
                    <bcf:outputpl value="#{wpis.netto}"/>
                    <br/>
                    <bcf:outputpl value="#{wpis.nettoWaluta}" rendered="#{wpis.symbolWaluty ne 'PLN'}"/> 
                    <h:outputText value="#{wpis.symbolWaluty}" rendered="#{wpis.symbolWaluty ne 'PLN'}"/>
                </p:column>
                <p:column id="status" headerText="tab"  style="width: 7%; text-align: center;">
                    <h:outputText value="#{wpis.tabelanbp.nrtabeli} " rendered="#{wpis.tabelanbp ne null and wpis.tabelanbp.waluta.symbolwaluty ne 'PLN'}" style="width: 50px;"/>
                    <h:outputText value="#{wpis.tabelanbp.kurssredni}" rendered="#{wpis.tabelanbp ne null and wpis.tabelanbp.waluta.symbolwaluty ne 'PLN'}" style="width: 50px;"/>
                </p:column>
            </p:dataTable>
    </h:form>
    <h:form  id="form_dokument_wpis_platnosci1">
        <p:panelGrid style="margin-top: 10px;" id="wprowadzanieplatnosci">
            <f:facet name="header">
            <p:row>
                <p:column>
                    <h:outputText value="lp"/>
                </p:column>
                <p:column>
                    <h:outputText value="typ płatności"/>
                </p:column>
                <p:column >
                    <h:outputText value="data płatności"/>
                </p:column>
                <p:column>
                    <h:outputText value="waluta"/>
                </p:column>
                 <p:column>
                    <h:outputText value="kwota"/>
                </p:column>
                <p:column>
                    <h:outputText value="tabela"/>
                </p:column>
                <p:column>
                    <h:outputText value="kurs"/>
                </p:column>
            </p:row>
            </f:facet>
            <p:row>
                <p:column style="width: 20px; text-align: center;" headerText="lp">
                <h:outputText value="#{index1+1}"/>
            </p:column>
            <p:column headerText="typ płatności" style="width: 70px;">
                <h:selectOneMenu value="#{platnosciWalutyView.nowa.typplatnosci}"
                    styleClass="ui-inputfield ui-inputtext ui-widget ui-state-default ui-corner-all"
                     onfocus="$(this).removeClass('ui-state-default');
                             $(this).addClass('ui-state-focus');"
                     onblur="$(this).removeClass('ui-state-focus');
                             $(this).addClass('ui-state-default');">
                    <f:selectItem itemValue="wb" itemLabel="wb"/>
                    <f:selectItem itemValue="rk" itemLabel="rk"/>
                    <f:selectItem itemValue="komp" itemLabel="komp"/>
                </h:selectOneMenu>
            </p:column>
            <p:column headerText="data płatności" style="width: 70px;">
                <p:inputText value="#{platnosciWalutyView.nowa.dataplatnosci}">
                    <p:ajax event="blur" partialSubmit="true" global="false"/>
                </p:inputText>
            </p:column>
            <p:column headerText="waluta"  style="width: 60px;">
                <h:selectOneMenu  id="wybranawaluta" value="#{platnosciWalutyView.nowa.walutadokumentu}" 
                                  valueChangeListener="#{platnosciWalutyView.pobierzkursNBP}" converter="WalutyConv"
                                  immediate="true" 
                                  styleClass="ui-inputfield ui-inputtext ui-widget ui-state-default ui-corner-all"
                                  onfocus="$(this).removeClass('ui-state-default');
                                          $(this).addClass('ui-state-focus');"
                                  onblur="$(this).removeClass('ui-state-focus');
                                          $(this).addClass('ui-state-default');"
                                  style="height: 26px;"
                                  >
                    <p:ajax event="change" partialSubmit="true" update="form_dokument_wpis_platnosci1:wprowadzanieplatnosci"/>
                    <f:selectItem itemValue="" itemLabel="wal" noSelectionOption="true"/>
                    <f:selectItems value="#{platnosciWalutyView.walutywdokum}" var="p" itemLabel="#{p.symbolwaluty}" itemValue="#{p}"/>
                </h:selectOneMenu>
            </p:column>
            <p:column headerText="kwota" style="width: 110px;">
                <bcf:inputpl value="#{platnosciWalutyView.nowa.kwota}"/>
            </p:column>
            <p:column headerText="tabela NBP" style="width: 110px;" >
                <h:outputText value="#{platnosciWalutyView.nowa.tabelanbp}"/>
            </p:column>
            <p:column headerText="kurs" style="width: 110px;" id="tabelanbp">
                <bcf:outputkurs value="#{platnosciWalutyView.nowa.tabelanbp.kurssredni}"/>
            </p:column>
            </p:row>
        </p:panelGrid>
    </h:form>
    <h:form id="form_dokument_wpis_platnosci2">
        <p:dataTable value="#{platnosciWalutyView.platnosci}" var="wpis1" id="dokumentyLista1" 
                     emptyMessage="brak płatności" style="margin-top: 20px; width: 800px;" rowIndexVar="index1"
                     >
            <f:facet name="header">
                <h:outputText value="płatności do dokumentu"/>
            </f:facet>
            <p:column style="width: 20px; text-align: center;" headerText="lp">
                <h:outputText value="#{index1+1}"/>
            </p:column>
            <p:column headerText="typ płatności" style="width: 70px;">
                <h:outputText value="#{wpis1.typplatnosci}"/>
            </p:column>
            <p:column headerText="data płatności" style="width: 100px;">
                <h:outputText value="#{wpis1.dataplatnosci}"/>
            </p:column>
            <p:column headerText="waluta"  style="width: 60px;">
                <h:outputText value="#{wpis1.walutadokumentu.symbolwaluty}"/>
            </p:column>
            <p:column headerText="kwota" style="width: 110px;">
                <bcf:outputpl value="#{wpis1.kwota}"/>
            </p:column>
        </p:dataTable>
    </h:form>
</ui:composition>   

