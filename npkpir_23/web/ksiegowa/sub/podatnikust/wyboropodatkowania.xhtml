<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:ft="http://primefaces.prime.com.tr/facestrace"
    xmlns:pe="http://primefaces.org/ui/extensions">
    <p:tab title="Wybór opodatkowania podatkiem dochodowym">  
        <h:form id="form1" >
            <h:outputText value="Wybór opodatkowania podatkiem dochodowym" style="font-size: 15px"/>
            <p:focus for="parametrypodatnika"/><br/>
            <h:outputText value="dane historyczne"/><br/>
            <p:dataTable value="#{podatnikView.podatnikOpodatkowanie}"  var="loop" style="width: 980px;" 
                         rowKey="#{loop.id}" selection="#{podatnikView.podatnikOpodatkowanieSelected}" selectionMode="single">
                <p:column headerText="od" width="80">
                        <h:outputText value="#{loop.mcOd}-" />
                        <h:outputText value="#{loop.rokOd}" />
                    </p:column>
                <p:column headerText="do" width="80">
                        <h:outputText value="#{loop.mcDo}-" />
                        <h:outputText value="#{loop.rokDo}" />
                    </p:column>
                    <p:column headerText="rodzaj opodatkowania">
                        <h:outputText value="#{loop.formaopodatkowania}" />
                    </p:column>
                    <p:column headerText="mies./kwart.">
                        <h:outputText value="#{loop.mc0kw1 eq false ? 'miesięcznie' : 'kwartalnie'}" />
                    </p:column>
                    <p:column headerText="stawka pod." rendered="#{WpisView.formaprawna eq 'SPOLKA_Z_O_O'}">
                        <h:outputText value="#{loop.stawkapodatkuospr}">
                            <f:convertNumber type="percent"/>
                        </h:outputText>
                    </p:column>
                    <p:column headerText="dołączony do roku">
                        <p:inplace  editor="true" saveLabel="zachowaj wprowadzoną wartość" cancelLabel="wycofaj wprowadzone zmiany">
                            <h:outputText value="#{loop.dolaczonydoroku eq null ? 'opcjonalne'  : loop.dolaczonydoroku}" />
                            <p:inputText value="#{loop.dolaczonydoroku}"
                                              label="text" />  
                                <p:ajax event="save" global="false" listener="#{podatnikView.edycjaopodatkowanie(loop)}" 
                                        partialSubmit="true"/>
                        
                        </p:inplace>
                    </p:column>
                    <p:column headerText="zamkniety" width="60" style="text-align: center;">
                        <h:outputText value="#{loop.zamkniety ? 'tak': 'nie'}" style="#{loop.zamkniety ? 'color: red;': 'color: green;'}"/>
                    </p:column>
                    <p:column  width="60" style="text-align: center;">
                        <p:commandButton icon="fa fa-lock" actionListener="#{podatnikView.zamknijrok(loop)}" global="true" update="@parent:@parent"
                                         style="#{loop.zamkniety ? 'color: green;': 'color: red;'}"/>
                    </p:column>
            </p:dataTable>
            <h:outputText value="wybierz parametry aktualne"/><br/>
            <p:panelGrid id="parametrypodatnika" columns="6" >
                <h:outputText value="data od: "/>
                <p:inputText id="dataod" value="#{podatnikView.wybranyPodatnikOpodatkowanie.datarozpoczecia}" maxlength="10" placeholder="rrrr-mm-dd" size="10">
                    <p:ajax event="blur" onstart="weryfikujsporzadzfakture()"/>
                </p:inputText>
                <h:outputText value="data od: "/>
                <p:inputText id="datado" value="#{podatnikView.wybranyPodatnikOpodatkowanie.datazakonczenia}" maxlength="10" placeholder="rrrr-mm-dd" size="10">
                    <p:ajax event="blur" onstart="weryfikujsporzadzfakture()"/>
                </p:inputText>
                <h:outputText value="symbol roku: "/>
                <p:selectOneMenu value="#{podatnikView.wybranyPodatnikOpodatkowanie.symbolroku}"><f:selectItems value="#{Roki.rokiListString}"/>
                </p:selectOneMenu>
                <h:outputText value="rodzaj opod: "/>
                <p:selectOneMenu value="#{podatnikView.wybranyPodatnikOpodatkowanie.formaopodatkowania}">
                    <f:selectItem itemValue="" itemLabel="wybierz" noSelectionOption="true"/> 
                    <f:selectItem itemValue="zasady ogólne" itemLabel="zasady ogólne"/> 
                    <f:selectItem itemValue="podatek liniowy" itemLabel="podatek liniowy"/>
                    <f:selectItem itemValue="ryczałt" itemLabel="ryczałt"/>
                    <f:selectItem itemValue="księgi rachunkowe" itemLabel="księgi rachunkowe"/>
                </p:selectOneMenu>
                <h:outputText value="mc/kw: "/>
                <p:selectOneMenu value="#{podatnikView.wybranyPodatnikOpodatkowanie.mc0kw1}" >
                    <f:selectItem itemLabel="miesięcznie" itemValue="false"/> 
                    <f:selectItem itemLabel="kwartalnie" itemValue="true"/>
                </p:selectOneMenu>
                <h:outputText value="stawka pod. (0,19)" rendered="#{WpisView.formaprawna eq 'SPOLKA_Z_O_O'}"/>
                <pe:inputNumber value="#{podatnikView.wybranyPodatnikOpodatkowanie.stawkapodatkuospr}" decimalPlaces="2" maxValue="1"  rendered="#{WpisView.formaprawna eq 'SPOLKA_Z_O_O'}"/>
            </p:panelGrid>
            <br/>
            <p:panelGrid columns="2" style="column-width: 350px; width: 500px">
                <p:commandButton action="#{podatnikView.usundoch()}" value="usun parametr" update="@form" type="submit"/>
                <p:commandButton action="#{podatnikView.dodajdoch()}" value="dodaj parametr" update="@form" type="submit"/>
            </p:panelGrid>
        </h:form>
        <br/><br/>
    </p:tab>
</ui:composition> 
