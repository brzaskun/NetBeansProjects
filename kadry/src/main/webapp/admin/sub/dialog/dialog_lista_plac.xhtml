<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://java.sun.com/jsf/facelets"

    xmlns:bcf="http://brzaskun.com/facelets"
>
    <p:dialog id="dialoglistaplac" header="Wyliczanie listy płac" widgetVar="dialoglistaplac"  
              resizable="false"  onShow="ustawdialog('dialoglistaplac','centertile',1650,800);" closeOnEscape="true" onHide="resetujdialog('dialoglistaplac');" 
              fitViewport="true">
        <p:ajax event="open" listener="#{pasekwynagrodzenView.init()}" update="DefinicjalistaplacCreateForm DefinicjalistaplacCreateForm1 KursDataLPForm DefinicjalistaplacCreateForm2 PasekwynagrodzenListForm" global="false"/>
        <h:outputText value="W przypadku braku osoby na zleceniu na liście proszę sprawdzić, czy wystawiono rachunek." style="color: #136e13;margin-top: 10px;"/>
        <p:outputPanel style="height: 275px">
            <style>
                .ui-picklist .ui-picklist-list{
                    width: 300px !important;
                }

            </style>
                <h:panelGroup >
                    
                    <p:panelGrid columns="6" rendered="#{pasekwynagrodzenView.listadefinicjalistaplac ne null}">
                       <h:form id="DefinicjalistaplacCreateForm">
                            <p:outputLabel value="rodzaj umowy" />
                            <p:selectOneListbox id="rodzajumowy" value="#{pasekwynagrodzenView.rodzajlistyplac}" scrollHeight="120" style="width: 280px;margin-left: 10px;" required="true" 
                                                 requiredMessage="Wybierz rodzaj listy płac"
                                 converter="#{rodzjalistyplacConverter}">
                                        <f:selectItem itemLabel="wybierz" noSelectionOption="true"/>
                                        <f:selectItems value="#{pasekwynagrodzenView.listarodzajlistyplac}"
                                                       var="firmalistaItem"
                                                       itemValue="#{firmalistaItem}" itemLabel="#{firmalistaItem.nazwa}"/>
                                        <p:ajax event="change" partialSubmit="true" listener="#{pasekwynagrodzenView.wyborinnejumowy()}" global="false" update="PasekwynagrodzenListForm DefinicjalistaplacCreateForm1 DefinicjalistaplacCreateForm2 KursDataLPForm"/>
                            </p:selectOneListbox>
                        </h:form>
                        <h:form id="DefinicjalistaplacCreateForm1">
                            <p:outputLabel value="wybrana lista płac" for="wybranalista" />
                            <p:selectOneListbox id="wybranalista" value="#{pasekwynagrodzenView.wybranalistaplac}" scrollHeight="120" required="true" style="width: 280px;" requiredMessage="Wybierz listę płac" converter="#{definicjalistaplacConverter}" >
                                <f:selectItem itemLabel="wybierz" noSelectionOption="true"/>
                                <f:selectItems value="#{pasekwynagrodzenView.listadefinicjalistaplac}" 
                                               var="firmalistaItem"
                                               itemValue="#{firmalistaItem}" itemLabel="#{firmalistaItem.opis} #{firmalistaItem.nrkolejny}"/>
                                <p:ajax event="change" partialSubmit="true" global="false" listener="#{pasekwynagrodzenView.pobierzkalendarzezamc}" update="PasekwynagrodzenListForm DefinicjalistaplacCreateForm2 KursDataLPForm"/>
                            </p:selectOneListbox>
                           
                            
                        </h:form>
                        <h:form id="KursDataLPForm">
                            <p:panelGrid columns="2" >
                            <h:outputLabel for="datawyplatypole" value="data wypłaty"/>
                            <p:inputText id="datawyplatypole" value="#{pasekwynagrodzenView.datawyplaty}" title="data wypłaty"  placeholder="____-__-__"  required="true" styleClass="dataUmowy" maxlength="10">
                                <p:ajax event="blur" onstart="ustawDateSprzedazy(#{wpisView.rokWpisu},#{wpisView.miesiacWpisu});" partialSubmit="true" global="false" listener="#{pasekwynagrodzenView.ustawtabelenbp()}" update="KursDataLPForm:kurspole"/>
                            </p:inputText>
                            <h:outputLabel for="kurspole" value="kurs przelicz."/>
                            <p:inputNumber value="#{pasekwynagrodzenView.kursdlalisty}" id="kurspole" decimalPlaces="4" style="text-align: right;">
                                <p:ajax event="blur" partialSubmit="true" global="false"/>
                            </p:inputNumber>
                           
                            <p:outputLabel value="forma listy płac" for="ileszczegolow" />
                            <p:selectOneMenu id="ileszczegolow" value="#{pasekwynagrodzenView.ileszczegolow}" requiredMessage="ile szczegółów"  >
                                <f:selectItem itemLabel="prosta" itemValue="prosta"/>
                                <f:selectItem itemLabel="normalna" itemValue="normalna"/>
                                <f:selectItem itemLabel="oddelegowanie" itemValue="oddelegowanie"/>
                                <p:ajax event="change" partialSubmit="true" global="false" update="PasekwynagrodzenListForm"/>
                            </p:selectOneMenu>
                            </p:panelGrid>
                        </h:form>
                         <h:form id="DefinicjalistaplacCreateForm2">
                            <p:outputLabel value="" for="wybranypracownik" />
                            <p:pickList id="wybranypracownik" value="#{pasekwynagrodzenView.listakalendarzmiesiac}" var="kalendarzItem" itemLabel="#{kalendarzItem.angaz.pracownik.nazwiskoImie}" itemValue="#{kalendarzItem}" 
                                        showCheckbox="true" converter="#{kalendarzmiesiacConverter}" showSourceFilter="true" showTargetFilter="true" filterMatchMode="contains"/>
                            <p:panelGrid columns="5" >
                            <p:commandButton styleClass="buttonnorm" actionListener="#{pasekwynagrodzenView.przelicz()}" value="oblicz" update="PasekwynagrodzenListForm DefinicjalistaplacCreateForm2:wybranypracownik" />
                            <p:commandButton styleClass="buttonnorm2" actionListener="#{pasekwynagrodzenView.mailListaPlac}" value="mail" update="PasekwynagrodzenListForm" />
                            <p:commandButton styleClass="buttonnorm2" actionListener="#{pasekwynagrodzenView.usun()}" value="usuń" update="PasekwynagrodzenListForm DefinicjalistaplacCreateForm2:wybranypracownik" />
                            <p:commandButton styleClass="buttonnorm2" actionListener="#{pasekwynagrodzenView.drukujliste}" value="druk lista"/>
                            <p:commandButton styleClass="buttonnorm2" actionListener="#{pasekwynagrodzenView.zapisz}" value="Save" update="PasekwynagrodzenListForm" />
                            </p:panelGrid>
                        </h:form>
<!--                        <p:selectOneMenu id="wybranypracownik" value="#{pasekwynagrodzenView.wybranykalendarz}" required="true" requiredMessage="Wybierz pracownika" converter="#{kalendarzmiesiacConverter}">
                            <f:selectItem itemLabel="wybierz" noSelectionOption="true"/>
                            <f:selectItems value="#{pasekwynagrodzenView.listakalendarzmiesiac}"
                                           var="kalendarzItem"
                                           itemValue="#{kalendarzItem}" itemLabel="#{kalendarzItem.angaz.pracownik.nazwiskoImie}"/>
                            <p:ajax event="change" listener="#{pasekwynagrodzenView.przelicz}" partialSubmit="true" global="false" update="@(form)"/>
                        </p:selectOneMenu>-->
                    </p:panelGrid>
                    
                </h:panelGroup>
            
        </p:outputPanel>
        <p:outputPanel>
            <h:form id="PasekwynagrodzenListForm">
                <ui:include src="dialog_lista_plac_sub_oddelegowanie.xhtml"/>
                <ui:include src="dialog_lista_plac_sub_normalna.xhtml"/>
                <ui:include src="dialog_lista_plac_sub_prosta.xhtml"/>
            </h:form>
        </p:outputPanel>
    </p:dialog>
</ui:composition>
